<?php
 namespace app\cli\logic; use think\Log; use app\index\service\Setting; use think\Db; class CleanServer { public function __construct() { } public function clean() { goto YA5eF; Xj7kP: return "\346\270\x85\xe7\x90\x86\xe6\210\220\345\212\237"; goto NkWCV; YA5eF: $this->cleanWeb(); goto VemcQ; VemcQ: $this->cleanDb(); goto Xj7kP; NkWCV: } protected function cleanWeb() { goto W0AcU; C4HAw: goto jxBFv; goto Olfdn; w941M: jqMst: goto DRi6o; RNkgg: RfO_4: goto h6LQp; MpG99: unlink($filePath); goto C4HAw; KTMF7: closedir($handle); goto y0NXb; oNldq: jxBFv: goto f9OCu; g5Ew0: if (!is_dir($filePath)) { goto XELTd; } goto Ar1Nl; BX7mP: unlink($filePath); goto RNkgg; Ar1Nl: goto jqMst; goto djWBo; W0AcU: $nowTime = time(); goto g5L2E; Olfdn: vouow: goto KTMF7; f9OCu: if (!(false !== ($file = readdir($handle)))) { goto vouow; } goto fCaLb; fCaLb: if (!($file == "\x2e" || $file == "\x2e\56")) { goto QGAA5; } goto m3nPx; MEj7R: $lastModTime = filemtime($filePath); goto wSn0Y; h6LQp: goto jqMst; goto irU8S; DRi6o: if (!(false !== ($file = readdir($handle)))) { goto c9LwK; } goto tVUAh; VJMxd: if (!is_dir($filePath)) { goto nJ5BL; } goto GOFI_; y0NXb: AoeD1: goto V3UHk; q_Z7z: closedir($handle); goto L5ZkI; c1n19: goto jqMst; goto E0Kxp; GOFI_: goto jxBFv; goto fADCh; E0Kxp: CsKIe: goto gwGNY; fADCh: nJ5BL: goto Kxvb7; xN4yA: Log::notice("\xe6\270\x85\xe7\x90\206\346\x97\245\xe5\277\227\xe6\x96\207\xe4\273\xb6\x3a\40{$filePath}"); goto BX7mP; Kxvb7: Log::notice("\346\xb8\x85\xe7\220\x86\xe8\247\x86\345\233\xbe\xe6\226\x87\344\xbb\266\x3a\x20{$filePath}"); goto MpG99; i1Di8: $filePath = $tmpPath . DS . $file; goto VJMxd; RtEVy: $tmpPath = rtrim(TEMP_PATH, "\57\134"); goto U5Keb; gwGNY: $filePath = $logPath . DS . $file; goto g5Ew0; djWBo: XELTd: goto MEj7R; g5L2E: $logPath = rtrim(LOG_PATH, "\57\x5c"); goto PgwTk; PgwTk: if (!(is_dir($logPath) && file_exists($logPath) && ($handle = opendir($logPath)))) { goto rwPXg; } goto w941M; m3nPx: goto jxBFv; goto y8hVs; tVUAh: if (!($file == "\x2e" || $file == "\x2e\x2e")) { goto CsKIe; } goto c1n19; U5Keb: if (!(is_dir($tmpPath) && file_exists($tmpPath) && ($handle = opendir($tmpPath)))) { goto AoeD1; } goto oNldq; L5ZkI: rwPXg: goto RtEVy; wSn0Y: if (!($nowTime > $lastModTime && $nowTime - $lastModTime > 30 * 24 * 3600)) { goto RfO_4; } goto xN4yA; y8hVs: QGAA5: goto i1Di8; irU8S: c9LwK: goto q_Z7z; V3UHk: } protected function cleanDb() { goto gVxmy; gGHug: Db::table("\152\157\x62\x5f\161\165\145\165\145")->whereTime("\145\156\x74\145\x72\145\144", "\x3c", $beginDate)->delete(); goto d3jfh; caIzM: Db::table("\x65\x76\x65\x6e\x74\137\154\157\147\x73")->whereTime("\x65\x6e\x74\145\162\x65\144", "\74", $beginDate)->delete(); goto U_d6x; Q101l: Db::table("\x6d\145\x73\x73\x61\147\x65\163")->whereTime("\x65\x6e\164\x65\x72\x65\x64", "\74", $beginDate)->delete(); goto caIzM; kIo4v: $beginDate = date("\x59\55\155\55\144", strtotime($today . "\x20\55\x31\x20\x6d\x6f\156\x74\150")); goto gGHug; gVxmy: $today = date("\x59\55\155\x2d\144"); goto kIo4v; d3jfh: $beginDate = date("\131\x2d\155\55\144", strtotime($today . "\40\55\x31\40\x6d\157\x6e\x74\150")); goto Q101l; U_d6x: } }
