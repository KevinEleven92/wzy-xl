<?php
 namespace app\cli\logic; use think\Log; use think\Db; use think\Cache; use app\mp\service\Subjects; use app\index\logic\License as LicenseLogic; class Orders { public function __construct() { } public function generateReportPdfs() { goto OlvNd; IZMPp: goto aXqAf; goto etyKc; ujEyJ: return "\345\275\223\xe5\x89\x8d\xe4\270\x8d\xe6\230\xaf\xe6\x9c\x89\xe6\225\210\347\x9a\x84\xe4\xbc\232\345\221\230\350\xb5\204\xe6\240\274\357\xbc\x8c\350\257\xa5\345\x8a\x9f\xe8\203\275\347\246\x81\347\224\xa8"; goto smimx; PneKH: KySXI: goto g1iNp; AUtqY: $failCount = 0; goto PneKH; g1iNp: $orders = Db::table("\163\165\142\152\145\x63\x74\x5f\157\x72\144\x65\162")->where(["\146\x69\x6e\151\163\x68\145\x64" => 1, "\x72\x65\160\x6f\x72\x74\x5f\160\144\x66" => null])->page(1, 100)->order("\151\x64\40\x64\145\163\143")->field("\x69\144\54\40\157\162\144\145\162\137\x6e\157")->select(); goto HzU8q; FKEVr: $successCount = 0; goto AUtqY; smimx: mnaEb: goto FKEVr; etyKc: ZtH2A: goto HJWue; ToJZc: BaErQ: goto rg6d1; X264S: return "\xe6\210\220\xe5\x8a\237\72{$successCount}\x2c\40\345\244\261\350\264\245{$failCount}"; goto gn_w6; b5jJi: if (true) { goto KySXI; } goto zI6ZS; zI6ZS: aXqAf: goto X264S; rg6d1: goto aXqAf; goto b5jJi; HJWue: foreach ($orders as $order) { goto u6WO1; CaO_j: $saveName = $orderNo . "\x2e\x70\144\x66"; goto WcKWk; f6F3f: goto f9rbb; goto C1sgs; ACZmF: Log::error("\x66\x61\151\x6c\145\144\40\x74\157\x20\146\x69\x6e\x64\40\123\x49\x54\105\137\125\122\x4c\x20\x69\156\x20\143\141\143\150\145"); goto NafIZ; C1sgs: wFxsf: goto rZxz8; Sc_65: goto f9rbb; goto d01Jd; VdYLn: file_put_contents($saveFullname, $pdfContent); goto zcTGT; zcTGT: Db::table("\x73\165\142\152\145\143\164\x5f\157\x72\144\145\x72")->where("\151\x64", $order["\x69\x64"])->update(["\162\x65\160\x6f\162\x74\137\x70\x64\x66" => $saveName]); goto wIv__; neWXu: $orderInfo = Subjects::I()->getOrderByNo($orderNo); goto vZuuf; wlxZs: $pdfFileName = file_get_contents($apiUrl); goto hAEbh; WcKWk: $saveFullname = EXPORT_DIR . DS . "\162\145\160\x6f\162\164\137\x70\144\146" . DS . $saveName; goto VdYLn; SiQfx: $failCount++; goto bESGZ; rZxz8: $url = url("\155\160\57\123\x75\142\152\145\143\164\x2f\162\145\160\157\x72\164", array_merge(generateMpAutoLoginParams($orderInfo["\143\165\163\164\157\x6d\x65\162\x5f\151\x64"]), ["\157\x72\144\145\x72\137\x6e\x6f" => $orderNo, "\151\x6e\164\145\x72\x6e\141\154\126\x69\x65\x77" => 1, "\160\144\146\126\151\145\167" => 1])); goto ya6mA; NafIZ: $failCount++; goto Sc_65; IomQ8: f9rbb: goto J97Kd; nUHes: fugpJ: goto vgPf7; d01Jd: xJpaX: goto L1Ukm; bESGZ: goto f9rbb; goto nUHes; vgPf7: $pdfUrl = "\150\164\164\x70\x3a\x2f\57\x77\x77\167\x2d\x74\x6c\x2e\163\157\154\x61\x72\161\x74\x2e\x63\157\x6d\72\x38\x30\x38\x31\57\x3f\x66\151\x6c\145\x3d" . urlencode($pdfFileName); goto gG8dE; U_xrL: $failCount++; goto f6F3f; gG8dE: $pdfContent = file_get_contents($pdfUrl); goto CaO_j; wIv__: $successCount++; goto IomQ8; L1Ukm: $url = $siteUrl . $url; goto HWaTe; u6WO1: $orderNo = $order["\x6f\x72\144\x65\x72\137\x6e\157"]; goto neWXu; upl7u: if (!empty($siteUrl)) { goto xJpaX; } goto ACZmF; hAEbh: if (!empty($pdfFileName)) { goto fugpJ; } goto SiQfx; HWaTe: $apiUrl = "\150\164\x74\x70\72\x2f\x2f\167\x77\167\x2d\164\x6c\56\x73\x6f\154\x61\x72\161\164\56\x63\x6f\155\72\70\60\x38\61\57\x3f\165\162\154\x3d" . urlencode($url); goto wlxZs; ya6mA: $siteUrl = Cache::get("\x53\x49\x54\x45\x5f\x55\122\x4c"); goto upl7u; vZuuf: if (!empty($orderInfo)) { goto wFxsf; } goto U_xrL; J97Kd: } goto ToJZc; HzU8q: if (!empty($orders)) { goto ZtH2A; } goto IZMPp; OlvNd: if (LicenseLogic::I()->checkVip()) { goto mnaEb; } goto ujEyJ; gn_w6: } }
