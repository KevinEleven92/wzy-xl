<?php
 namespace app\cli\logic; use think\Log; use think\Db; use think\Cache; use app\mp\service\Subjects; use app\Index\logic\License as LicenseLogic; class Orders { public function __construct() { } public function generateReportPdfs() { goto v73TI; Cysf6: lwckY: goto uQzoX; j1aNh: if (true) { goto Sb8oI; } goto Cysf6; Gtllo: $orders = Db::table("\x73\165\142\152\145\x63\164\x5f\x6f\x72\144\145\162")->where(["\x66\x69\156\151\163\x68\x65\144" => 1, "\162\x65\160\x6f\162\x74\x5f\160\x64\146" => null])->page(1, 100)->order("\x69\144\x20\144\x65\x73\x63")->field("\x69\x64\54\x20\157\x72\144\145\162\x5f\156\x6f")->select(); goto gtw3w; SAxc9: $successCount = 0; goto hsFkC; gtw3w: if (!empty($orders)) { goto dJugb; } goto qoQ60; Mi_rX: QDs3D: goto SAxc9; hsFkC: $failCount = 0; goto Ohgyr; yTd82: return "\xe5\275\x93\345\x89\215\344\xb8\x8d\xe6\x98\257\xe6\x9c\211\346\225\210\xe7\232\x84\xe4\274\232\xe5\x91\x98\xe8\265\x84\346\xa0\xbc\xef\xbc\x8c\350\xaf\xa5\345\212\x9f\350\203\275\xe7\xa6\x81\347\224\250"; goto Mi_rX; v73TI: if (LicenseLogic::I()->checkVip()) { goto QDs3D; } goto yTd82; Lc9s5: dJugb: goto aVAA9; uQzoX: return "\346\210\220\xe5\x8a\237\x3a{$successCount}\x2c\x20\xe5\xa4\xb1\xe8\xb4\xa5{$failCount}"; goto am9Ss; qoQ60: goto lwckY; goto Lc9s5; k1XoV: J8RSa: goto q5IeX; q5IeX: goto lwckY; goto j1aNh; Ohgyr: Sb8oI: goto Gtllo; aVAA9: foreach ($orders as $order) { goto Cvb19; xzL3c: a_Ord: goto l4KPQ; nRhiN: $failCount++; goto tryRF; hGEZ3: $saveName = $orderNo . "\x2e\160\144\x66"; goto uBzXi; E6DB4: QU8VF: goto IsmJa; qUIhy: $pdfUrl = "\150\x74\x74\160\x3a\57\57\x77\167\167\55\x74\154\56\163\157\154\x61\162\161\x74\56\143\x6f\155\72\70\60\x38\x31\57\x3f\146\151\154\145\x3d" . urlencode($pdfFileName); goto ogeM7; uBzXi: $saveFullname = EXPORT_DIR . DS . "\x72\145\x70\157\162\164\137\x70\144\146" . DS . $saveName; goto ewpqV; roV89: goto yQQSW; goto xzL3c; l4KPQ: $url = $siteUrl . $url; goto stedo; gUI59: $failCount++; goto QekbN; QekbN: goto yQQSW; goto E6DB4; tryRF: goto yQQSW; goto WG_Ki; Cvb19: $orderNo = $order["\157\162\144\x65\x72\x5f\x6e\x6f"]; goto RmizS; OK49_: if (!empty($siteUrl)) { goto a_Ord; } goto VsaQu; stedo: $apiUrl = "\x68\x74\164\160\x3a\x2f\57\167\167\167\55\164\154\56\163\x6f\154\x61\162\161\x74\56\x63\157\x6d\72\70\60\70\61\x2f\x3f\165\x72\154\75" . urlencode($url); goto CFW4V; CFW4V: $pdfFileName = file_get_contents($apiUrl); goto Zzrn6; Zzrn6: if (!empty($pdfFileName)) { goto MDiHC; } goto nRhiN; xIA8O: yQQSW: goto xdM9V; ogeM7: $pdfContent = file_get_contents($pdfUrl); goto hGEZ3; ewpqV: file_put_contents($saveFullname, $pdfContent); goto ojsSY; druU6: $successCount++; goto xIA8O; IsmJa: $url = url("\155\160\x2f\123\x75\x62\152\145\143\164\x2f\x72\x65\160\x6f\162\164", array_merge(generateMpAutoLoginParams($orderInfo["\x63\x75\x73\x74\x6f\x6d\x65\x72\x5f\151\144"]), ["\157\x72\144\x65\162\137\156\x6f" => $orderNo, "\x69\156\x74\145\x72\x6e\141\x6c\x56\151\x65\167" => 1, "\x70\x64\146\x56\x69\x65\167" => 1])); goto K0sSZ; ojsSY: Db::table("\x73\x75\142\152\145\143\x74\x5f\x6f\x72\144\145\162")->where("\x69\144", $order["\x69\144"])->update(["\162\x65\160\157\162\164\x5f\160\144\146" => $saveName]); goto druU6; RmizS: $orderInfo = Subjects::I()->getOrderByNo($orderNo); goto sUlt7; K0sSZ: $siteUrl = Cache::get("\123\111\x54\x45\137\x55\122\x4c"); goto OK49_; sUlt7: if (!empty($orderInfo)) { goto QU8VF; } goto gUI59; WG_Ki: MDiHC: goto qUIhy; VsaQu: Log::error("\x66\x61\x69\154\145\x64\x20\164\157\40\x66\x69\x6e\144\x20\123\111\x54\105\x5f\125\x52\114\40\x69\x6e\x20\x63\141\143\150\x65"); goto Doa74; Doa74: $failCount++; goto roV89; xdM9V: } goto k1XoV; am9Ss: } }
