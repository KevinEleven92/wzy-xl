<?php
 namespace app\mp\logic; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\mp\service\Subjects; use app\Defs; use app\index\logic\Subject as SubjectLogic; use EasyWeChat\Factory; use app\index\service\EventLogs as EventLogsService; class Dian extends Base { public function genOrder($good_id, $subject_id) { goto Zf812; ROgc7: Db::table("\x64\x69\x61\156\137\147\157\157\144\x73")->where(["\x69\x64" => $good_id])->update(["\163\164\141\x74\165\163" => Defs::eGoodsUsed]); goto bTN6E; R3pFu: SNDJh: goto wquXU; hlFz_: $order["\147\157\157\144\163\x5f\x69\x64"] = $good_id; goto SKNKh; GBRnM: wexception("\xe6\265\x8b\xe8\257\x84\351\x87\217\xe8\xa1\xa8\345\x8c\x85\xe5\x90\253\xe7\232\x84\xe9\xa2\x98\347\x9b\xae\344\270\272\xe7\xa9\xba"); goto P6pZz; ZjMt9: $order["\161\165\145\x73\x74\151\157\x6e\137\146\157\x72\155"] = $subject["\x71\165\x65\x73\164\x69\x6f\x6e\x5f\x66\157\162\x6d"]; goto HAZcA; TiDDh: wexception("\xe6\x97\240\346\263\x95\xe6\211\xbe\345\210\xb0\350\xaf\245\351\207\217\350\241\xa8"); goto R3pFu; Zf812: $subject = Subjects::I()->getSubjectById($subject_id); goto NdBk5; xRIdZ: return $order["\157\162\x64\x65\162\x5f\x6e\x6f"]; goto Xjrcm; SKNKh: $order["\163\x75\142\152\145\143\164\137\151\x64"] = $subject_id; goto CdWA7; SZrAj: $order["\157\x72\x64\x65\162\137\x61\155\x6f\x75\x6e\x74"] = 0; goto TRyio; OHq5A: wexception("\346\225\xb0\xe6\x8d\xae\345\272\x93\xe6\x96\260\xe5\242\x9e\350\xae\242\xe5\215\x95\345\274\x82\345\xb8\270"); goto RK3kW; VWxPU: $order = []; goto fpF7a; Bnmhc: $order["\x69\x74\145\x6d\x73"] = ''; goto SZrAj; NdBk5: if ($subject) { goto SNDJh; } goto TiDDh; H20Qg: Db::table("\163\165\142\x6a\x65\143\164")->where(["\151\144" => $subject_id])->setInc("\x74\157\x74\141\154\x5f\x61\155\157\x75\x6e\164", $order["\157\x72\144\145\x72\x5f\x61\x6d\x6f\x75\x6e\x74"]); goto xRIdZ; P6pZz: vAAXr: goto VWxPU; wquXU: if (!(empty($subject["\143\x75\163\164\x6f\155\137\x74\x65\163\x74"]) && $subject["\x69\164\x65\155\163"] == 0)) { goto vAAXr; } goto GBRnM; TRyio: $order["\x69\164\x65\x6d\x5f\166\145\x72\163\x69\157\x6e"] = $subject["\151\x74\x65\x6d\137\x76\x65\x72\163\151\157\156"]; goto ZjMt9; kYTE7: if (!empty($res)) { goto eP6DO; } goto OHq5A; HAZcA: $res = Db::table("\x64\151\141\156\137\157\x72\144\x65\162")->insert($order); goto kYTE7; bTN6E: Db::table("\163\x75\142\x6a\145\143\164")->where(["\x69\x64" => $subject_id])->setInc("\x70\141\x72\x74\151\143\151\160\141\x6e\x74\163"); goto EUQsK; EUQsK: Db::table("\163\165\142\x6a\145\143\x74")->where(["\x69\144" => $subject_id])->setInc("\x70\141\x72\164\151\x63\x69\160\x61\156\x74\x73\137\x73\x68\x6f\x77"); goto H20Qg; fpF7a: $order["\157\162\x64\145\x72\x5f\156\157"] = generateSequenceNo(rand(1, 999), Defs::SUBJECT_ORDER_NO_SEQ_NUM_KEY, "\x53"); goto hlFz_; CdWA7: $order["\164\x6f\164\141\x6c\137\151\x74\x65\x6d\163"] = $subject["\151\x74\145\155\163"]; goto Bnmhc; RK3kW: eP6DO: goto ROgc7; Xjrcm: } public function regenOrder($subject_id, $order_no) { goto OFrKx; Fxq_G: $order["\x71\x75\x65\163\164\151\x6f\156\x5f\141\x6e\163\167\145\162"] = ''; goto qvo9s; c8msp: $order["\164\x6f\164\x61\154\137\151\164\x65\155\163"] = $subject["\151\x74\x65\155\163"]; goto uCWV6; yt842: $order["\x71\x75\x65\x73\x74\x69\157\x6e\x5f\x66\x6f\162\155"] = $subject["\x71\165\x65\x73\164\x69\x6f\x6e\137\x66\157\x72\x6d"]; goto Fxq_G; hdeZJ: if (!empty($subject)) { goto BNRQg; } goto UZCEr; ayInC: if (!empty($order)) { goto n7gmk; } goto P92SX; P92SX: wexception("\xe6\265\x8b\350\257\x84\350\xae\242\xe5\x8d\225\xe4\270\215\345\xad\x98\xe5\x9c\250\357\274\x9a" . $order_no); goto PjVAu; uCWV6: $order["\x74\x65\x73\x74\x5f\x69\x74\145\x6d\x73"] = 0; goto w_osj; UZCEr: wexception("\346\xb5\213\xe8\257\x84\344\270\215\xe5\255\x98\xe5\234\xa8"); goto cGynq; cGynq: BNRQg: goto MwmlM; PjVAu: n7gmk: goto jzXEo; h7On7: $order["\146\151\x6e\x69\163\x68\x65\x64"] = 0; goto yt842; RR43k: $order["\x72\x65\x73\165\x6c\x74"] = null; goto h7On7; qvo9s: $order["\151\x74\145\x6d\x5f\x76\145\162\163\151\157\x6e"] = $subject["\151\164\145\x6d\137\166\145\162\x73\151\157\156"]; goto iiIGC; OFrKx: $order = Db::table("\x64\x69\141\156\137\x6f\x72\x64\145\162")->where(["\157\162\x64\145\162\137\156\157" => $order_no])->field(true)->find(); goto ayInC; MxLUo: $order["\151\x74\145\155\x73"] = ''; goto RR43k; jzXEo: $subject = Subjects::I()->getSubjectById($subject_id); goto hdeZJ; w_osj: $order["\143\x75\x72\162\x5f\x69\x74\145\155"] = 0; goto MxLUo; iiIGC: Db::table("\144\151\141\156\x5f\157\162\144\x65\x72")->where("\157\x72\x64\x65\x72\137\156\x6f", $order_no)->update($order); goto vddIq; MwmlM: $order = []; goto c8msp; vddIq: } }
