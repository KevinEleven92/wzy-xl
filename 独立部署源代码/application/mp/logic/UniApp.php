<?php
 namespace app\mp\logic; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\mp\service\Subjects; use app\Defs; use app\index\logic\Subject as SubjectLogic; use EasyWeChat\Factory; use app\index\service\EventLogs as EventLogsService; class UniApp extends Base { public function login($channel, $code = '') { goto Moblm; gFD1d: goto Q55Zd; goto POhgd; AOIZB: oJQNE: goto ivQKK; mWekH: return ["\163\x65\x73\x73\151\157\x6e\137\153\x65\x79" => $sessionKey, "\150\145\x61\144\x69\x6d\x67\x5f\165\x72\x6c" => $headimgUrl]; goto yjdeu; OVoXd: if (!$user["\150\x65\141\144\151\155\x67\137\x75\x72\154"]) { goto nW00N; } goto STyba; ivQKK: Db::table("\x75\156\x69\137\141\x70\160\x5f\165\x73\145\x72\x73")->where("\x6f\160\145\x6e\151\x64", $openid)->update(["\163\x65\163\163\151\157\x6e\x5f\x6b\145\x79" => $sessionKey, "\x6c\x61\164\145\x73\164\x5f\154\x6f\147\x69\156\137\x74\151\x6d\x65" => Db::raw("\156\x6f\x77\50\51")]); goto OVoXd; pLEDN: $loginResult = $this->_loginBaidu($code); goto ASQgK; dQCYI: $openid = "\x6f\160\x65\156\151\144"; goto snJi1; tfBXr: $channel = "\x48\65"; goto yu5DV; itWdJ: $loginResult = $this->_loginWeixin($code); goto IbYDw; FtOU4: tTAOM: goto itWdJ; i0oVN: $user = Db::table("\x75\156\151\x5f\x61\160\x70\x5f\165\163\x65\162\163")->where("\157\x70\x65\156\x69\x64", $openid)->field(true)->find(); goto wDyMr; TlP7i: Jxs1q: goto gFD1d; IbYDw: $openid = $loginResult["\157\x70\145\x6e\x69\x64"]; goto YRfvW; Moblm: if ($channel == "\x42\101\x49\x44\x55") { goto lVit6; } goto cyDAj; ASQgK: $openid = $loginResult["\157\160\145\156\151\x64"]; goto n08AY; yu5DV: goto Jxs1q; goto FtOU4; POhgd: lVit6: goto pLEDN; wDyMr: if ($user) { goto oJQNE; } goto J2VrX; n08AY: $sessionKey = $loginResult["\163\145\x73\x73\151\157\x6e\x5f\153\145\171"]; goto Qmxfr; YRfvW: $sessionKey = $loginResult["\x73\145\163\163\151\157\156\x5f\x6b\145\171"]; goto TlP7i; snJi1: $sessionKey = "\x73\x65\x73\x73\151\x6f\156\x5f\x6b\145\x79"; goto tfBXr; cyDAj: if ($channel == "\x57\x45\x49\130\x49\116") { goto tTAOM; } goto dQCYI; Ba7s8: goto OxTmy; goto AOIZB; qO3Ak: OxTmy: goto mWekH; Qmxfr: Q55Zd: goto Y9oZw; Y9oZw: $headimgUrl = generateUploadFullUrl("\57\x73\x74\x61\x74\151\x63\57\x69\x6d\147\x2f\141\x76\141\x74\141\162\56\x70\156\x67"); goto i0oVN; STyba: $headimgUrl = generateUploadFullUrl($user["\150\145\141\144\x69\x6d\147\x5f\x75\162\154"]); goto IdMlS; IdMlS: nW00N: goto qO3Ak; J2VrX: Db::table("\x75\x6e\x69\x5f\x61\160\x70\137\165\x73\x65\x72\x73")->insert(["\x6f\160\145\x6e\151\144" => $openid, "\163\x65\x73\x73\x69\157\x6e\137\153\x65\x79" => $sessionKey, "\x72\145\x67\151\x73\164\145\162\137\164\151\x6d\145" => Db::raw("\156\157\x77\50\51"), "\x6c\141\164\145\163\164\x5f\x6c\x6f\147\x69\156\137\x74\151\x6d\x65" => Db::raw("\156\x6f\x77\x28\x29"), "\x63\x68\141\x6e\x6e\x65\x6c" => $channel]); goto Ba7s8; yjdeu: } private function _loginBaidu($code) { goto OWCDw; jQF7G: if (!empty($jsonObj)) { goto AXbUW; } goto tP9Ho; yJGR5: $output = curl_exec($curl); goto TGs5h; A3lxh: $sessionKey = $jsonObj["\163\145\x73\163\x69\157\x6e\137\x6b\x65\171"]; goto tdnpg; KxEXk: m1Q9k: goto jmCzW; togrk: curl_setopt($curl, CURLOPT_URL, $url); goto zmved; PaZ5U: exception("\xe6\x97\xa0\346\263\225\350\xa7\xa3\346\236\x90\x6f\x70\x65\156\151\144\x3a\x20" . $output); goto KxEXk; MQnv9: Log::notice("\142\141\151\144\x75\40\x6f\141\165\164\x68\x20\162\145\x73\160\x6f\156\x73\145\72\40{$output}"); goto mKJjn; EFMmp: $url .= "\x3f"; goto U_Wic; f0EwN: sb8h7: goto MQnv9; J3LFh: curl_close($curl); goto AEki5; zmved: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto C78gK; ORH1m: $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); goto J3LFh; n1Br2: curl_close($curl); goto asxAy; l2OEi: Log::notice("\x62\141\x69\144\165\x20\x6f\x61\x75\x74\x68\x20\162\145\x71\165\145\x73\164\72\40" . var_export($postDataArr, true)); goto hD4vl; LUGg4: $errCode = curl_errno($curl); goto FqV_2; asxAy: exception("\xe6\227\xa0\346\xb3\x95\350\216\267\345\276\227\xe7\231\276\345\272\xa6\346\234\x8d\345\x8a\241\345\x99\xa8\345\272\224\xe7\255\x94\54\x20{$errCode}\40\55\40{$errMsg}"); goto HWW2T; tP9Ho: exception("\xe6\x97\xa0\xe6\xb3\x95\xe8\247\xa3\xe6\236\x90\345\272\224\xe7\255\224\x3a\40" . $output); goto ejTd7; wJCF9: exception("\347\x99\xbe\xe5\272\246\xe5\272\224\347\255\x94\x68\164\x74\160\x20\x63\157\144\145\x3a\x20{$httpCode}"); goto f0EwN; tdnpg: return ["\x6f\160\145\x6e\x69\144" => $openid, "\163\x65\163\163\x69\157\x6e\x5f\x6b\x65\x79" => $sessionKey]; goto S4IHr; ejTd7: AXbUW: goto lRrJS; jmCzW: $openid = $jsonObj["\x6f\x70\x65\156\151\144"]; goto A3lxh; U_Wic: $url .= http_build_query($postDataArr); goto l2OEi; C78gK: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto GnGbB; FqV_2: $errMsg = curl_error($curl); goto n1Br2; OWCDw: $url = "\150\164\x74\x70\x73\x3a\57\57\x73\x70\x61\x70\x69\56\x62\x61\x69\144\x75\x2e\143\157\155\x2f\x6f\141\165\164\x68\x2f\152\x73\143\157\144\145\x32\163\x65\163\163\151\x6f\156\153\145\171"; goto zHwG7; lRrJS: if (isset($jsonObj["\157\160\x65\x6e\151\x64"])) { goto m1Q9k; } goto PaZ5U; hk_YN: $headerArr = array("\x43\157\x6e\x74\145\156\164\55\164\171\160\145\72\141\160\160\154\151\143\x61\x74\151\x6f\156\x2f\x78\x2d\x77\167\x77\x2d\146\157\x72\x6d\x2d\x75\x72\154\x65\x6e\x63\157\144\x65\x64"); goto EFMmp; GnGbB: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto yJGR5; hD4vl: $curl = curl_init(); goto togrk; TGs5h: if (!empty($output)) { goto svBy1; } goto LUGg4; mKJjn: $jsonObj = json_decode($output, true); goto jQF7G; zHwG7: $postDataArr = array("\143\157\144\145" => $code, "\143\x6c\151\145\x6e\164\137\151\x64" => "\167\x49\x47\x35\x41\x6f\161\x6a\x4c\121\x64\102\126\111\x54\172\131\x74\130\170\x49\170\104\104\x45\x30\x71\x39\x52\x47\102\x4e", "\x73\153" => "\x47\x51\x41\70\71\165\x53\x58\166\117\x46\x37\x57\114\114\121\x68\x6e\x42\x63\156\x6e\x59\67\116\x62\x31\123\x4e\125\167\x64"); goto hk_YN; AEki5: if (!($httpCode != "\x32\60\x30")) { goto sb8h7; } goto wJCF9; HWW2T: svBy1: goto ORH1m; S4IHr: } private function _loginWeixin($code) { goto hfq9F; Kfyc9: $openid = $wxUser["\157\x70\x65\156\x69\144"]; goto UpUj5; hfq9F: wxPaySetting(); goto evXWz; Wzjaj: $wxUser = $app->auth->session($code); goto GcEj_; GcEj_: if ($wxUser) { goto Fryuh; } goto REDmW; y1V10: if (!(!isset($wxUser["\x6f\160\x65\x6e\x69\x64"]) || !isset($wxUser["\x73\x65\x73\163\x69\x6f\x6e\x5f\x6b\x65\x79"]))) { goto JG40D; } goto LMABr; LMABr: exception("\xe5\xbe\xae\344\xbf\xa1\xe7\231\273\xe5\xbd\225\xe5\244\261\350\264\xa5\72\40" . var_export($wxUser, true)); goto J_kdh; J_kdh: JG40D: goto Czmbc; evXWz: $app = Factory::miniProgram(config("\x77\x78\x2e\x6d\151\156\x69\137\160\x72\x6f\147\162\141\155")); goto Wzjaj; tAmkf: Fryuh: goto y1V10; REDmW: exception("\xe5\xbe\256\xe4\277\241\347\x99\273\xe5\275\225\xe5\xba\x94\xe7\xad\x94\344\270\xba\xe7\251\272"); goto tAmkf; Czmbc: Log::notice("\167\x65\151\170\x69\156\40\x6f\x61\x75\164\150\x20\162\145\163\x70\x6f\156\163\x65\72\40" . var_export($wxUser, true)); goto Kfyc9; UpUj5: $sessionKey = $wxUser["\x73\x65\x73\x73\x69\x6f\156\137\x6b\145\171"]; goto Bkrw1; Bkrw1: return ["\x6f\160\145\x6e\x69\x64" => $openid, "\163\145\163\163\x69\157\x6e\137\153\x65\171" => $sessionKey]; goto MNYBe; MNYBe: } public function logout($session_key) { Db::table("\x75\156\151\x5f\x61\x70\160\137\x75\163\x65\x72\x73")->where("\163\x65\x73\x73\x69\x6f\x6e\137\x6b\145\x79", $session_key)->update(["\163\145\163\163\x69\157\156\137\x6b\145\171" => '']); } public function subjectsPopular() { goto j7LfS; j7LfS: $rows = Db::query("\163\145\154\x65\x63\164\x20\151\144\54\40\156\141\x6d\x65\x2c\40\163\165\142\164\151\164\x6c\145\54\40\x69\155\141\x67\145\x5f\x75\x72\x6c\x2c\40\142\141\156\x6e\x65\162\137\151\x6d\147\54\x20\151\164\145\155\x73\x2c\x20\x70\141\x72\164\151\x63\151\160\x61\156\164\x73\137\x73\x68\157\x77\x20\141\163\x20\x70\141\x72\x74\151\x63\x69\160\x61\x6e\164\163\x2c\x20\143\x75\x72\x72\x65\x6e\164\x5f\x70\x72\151\143\x65\40\xd\xa\11\11\11\x9\11\x9\x9\146\162\157\155\40\163\x75\142\152\145\x63\x74\x20\15\12\x9\x9\11\11\x9\11\x9\167\x68\x65\162\145\x20\x46\111\116\x44\x5f\x49\116\137\123\x45\124\x28\47\160\157\x70\165\154\141\x72\x27\x2c\40\154\x61\x62\145\154\x29\40\x61\x6e\144\40\x64\145\154\x65\x74\x65\x5f\x66\154\x61\147\x3d\60\40\141\x6e\144\x20\x73\164\x61\x74\x75\x73\75" . IndexDefs::ENTITY_PUBLISH_STATUS . "\x20\141\156\x64\x20\x75\156\151\137\141\x70\160\x3d\61\15\12\x9\x9\11\x9\x9\x9\x9\117\x52\x44\x45\x52\40\102\131\x20\x52\101\x4e\x44\50\51\x20\114\x49\x4d\x49\124\40\x34"); goto PblNF; PblNF: foreach ($rows as &$row) { goto yYNGU; yYNGU: $imageUrl = $row["\151\155\141\147\145\x5f\x75\162\x6c"]; goto Xz76e; swulr: wAFjR: goto KQnRX; CPz8Z: $row["\x63\141\164\x65\147\x6f\x72\171\137\156\x61\x6d\145\x73"] = $categoryNames; goto swulr; b7Qbu: $row["\160\141\162\164\151\x63\151\x70\141\156\x74\163"] = formatTimes($row["\x70\141\162\164\151\143\x69\x70\x61\x6e\164\x73"]); goto QUPOe; QUPOe: $categoryNames = Db::table("\x73\165\142\152\145\x63\164\137\x63\141\164\x65\147\157\162\171\x5f\x72\x65\154\x61\164\145")->alias("\123\x43\122")->join("\x63\x61\164\145\147\157\162\151\145\163\40\103", "\x53\103\x52\56\x63\141\164\145\x67\x6f\162\x79\x5f\151\144\x3d\x43\x2e\151\144\x20\x61\x6e\x64\x20\x53\x43\122\x2e\163\165\x62\x6a\145\143\164\x5f\x69\144\x3d" . $row["\x69\x64"])->column("\103\x2e\x6e\141\155\145"); goto CPz8Z; Xz76e: $row["\x69\155\x61\147\145\x5f\165\x72\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto s5wsD; s5wsD: $row["\142\x61\156\x6e\x65\x72\137\151\x6d\147"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto b7Qbu; KQnRX: } goto zTtqe; NwkJG: return $rows; goto zRZBv; zTtqe: MHs3A: goto NwkJG; zRZBv: } public function subjectsFeatured() { goto i7g6X; ovpot: foreach ($rows as &$row) { goto y4TQN; Xk6ht: $row["\143\141\x74\145\147\x6f\x72\x79\x5f\156\x61\x6d\145\163"] = $categoryNames; goto CEWwA; Xa1qw: $row["\x62\141\x6e\x6e\x65\162\x5f\151\x6d\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto LdmH6; HsGRd: $row["\x69\x6d\141\147\145\137\165\162\154"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto Xa1qw; uEr6k: $categoryNames = Db::table("\163\x75\142\152\x65\x63\x74\137\x63\141\164\x65\147\157\162\x79\x5f\x72\x65\x6c\x61\x74\x65")->alias("\123\x43\122")->join("\143\x61\x74\x65\147\x6f\162\151\x65\163\x20\x43", "\123\103\x52\56\143\x61\164\145\147\157\162\171\x5f\151\x64\x3d\x43\56\x69\144\40\x61\x6e\144\40\x53\x43\x52\56\x73\165\142\152\x65\143\164\x5f\x69\144\x3d" . $row["\151\144"])->column("\103\x2e\x6e\141\155\145"); goto Xk6ht; CEWwA: PgCx_: goto EMHTM; y4TQN: $imageUrl = $row["\151\155\141\147\x65\137\165\162\154"]; goto HsGRd; LdmH6: $row["\160\x61\162\x74\x69\x63\151\160\x61\x6e\x74\163"] = formatTimes($row["\x70\141\x72\x74\151\143\x69\x70\141\x6e\x74\x73"]); goto uEr6k; EMHTM: } goto y9Wp3; tU7PR: return $rows; goto we2AF; i7g6X: $rows = Db::query("\163\x65\x6c\145\143\x74\40\151\144\54\x20\x6e\x61\155\145\54\x20\x73\x75\142\164\151\164\154\x65\54\40\151\155\141\147\x65\x5f\x75\162\154\54\x20\142\141\x6e\x6e\145\162\137\x69\x6d\x67\x2c\40\151\x74\145\155\163\x2c\40\x70\x61\162\x74\151\x63\151\160\141\156\x74\x73\137\x73\x68\x6f\167\40\x61\x73\40\x70\141\162\x74\x69\x63\x69\x70\141\156\164\163\x2c\x20\x63\165\162\162\145\x6e\x74\137\x70\x72\x69\x63\x65\40\15\12\x9\11\x9\11\x9\11\x9\146\162\x6f\x6d\x20\163\165\x62\152\145\x63\x74\40\15\12\x9\x9\11\11\x9\x9\11\167\150\145\162\x65\40\x46\x49\116\x44\x5f\111\116\137\x53\105\x54\50\47\x66\x65\x61\x74\x75\x72\x65\144\47\x2c\40\154\x61\142\145\154\x29\x20\141\156\144\40\x64\145\154\x65\x74\x65\x5f\x66\x6c\x61\147\x3d\x30\40\141\x6e\144\40\163\x74\141\x74\x75\163\75" . IndexDefs::ENTITY_PUBLISH_STATUS . "\40\x61\x6e\144\x20\165\156\x69\137\141\160\160\x3d\x31\xd\12\x9\x9\x9\11\11\x9\x9\157\162\144\x65\x72\x20\142\171\x20\x73\157\162\164\40\x61\163\143"); goto ovpot; y9Wp3: T0ubI: goto tU7PR; we2AF: } public function subjectsInCategory($categoryId, $kw) { goto nif2i; UCrui: if (!$kw) { goto dQJCW; } goto oOMba; rwiV9: goto uHI5x; goto TVzHI; yYOD0: $where["\123\56\x73\x74\141\164\x75\163"] = ["\151\156", [IndexDefs::ENTITY_PUBLISH_STATUS]]; goto qPt_z; vRj2A: uHI5x: goto K4laA; dnFbw: return $rows; goto hvJoB; eys8f: dQJCW: goto ZSz0A; EVFGl: $where["\123\x2e\x64\145\x6c\145\164\145\137\146\x6c\x61\147"] = 0; goto yYOD0; oOMba: $where["\123\x2e\x6e\141\x6d\145"] = ["\x6c\151\153\145", "\x25" . $kw . "\x25"]; goto eys8f; a0Tb7: $rows = Db::table("\x73\165\x62\x6a\x65\143\164")->alias("\123")->where($where)->order("\x53\56\x73\x6f\162\164\40\141\163\143")->field("\x53\56\x69\144\54\x53\56\x6e\x61\155\x65\54\123\56\x73\165\x62\164\151\x74\x6c\145\54\123\56\x69\155\x61\147\x65\x5f\165\x72\154\54\123\56\142\x61\156\x6e\x65\x72\137\151\x6d\x67\x2c\123\x2e\151\164\x65\155\x73\x2c\123\x2e\160\x61\x72\x74\x69\143\x69\160\141\156\164\x73\137\x73\x68\157\167\40\x61\163\x20\x70\141\x72\x74\x69\143\151\160\x61\x6e\164\163\54\123\x2e\x63\x75\162\x72\145\156\x74\137\x70\162\151\x63\145")->select(); goto vRj2A; Daytx: foreach ($rows as &$row) { goto Nvkkp; P8RyR: $row["\142\141\156\156\x65\162\137\151\x6d\147"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto rMvbV; QcIxe: $row["\x69\x6d\x61\147\145\x5f\x75\162\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto P8RyR; r9zU3: $categoryNames = Db::table("\x73\165\142\x6a\145\143\x74\x5f\143\x61\164\x65\x67\157\162\171\137\162\x65\154\141\x74\145")->alias("\x53\x43\x52")->join("\x63\141\x74\145\x67\x6f\162\x69\x65\x73\40\x43", "\x53\103\x52\x2e\143\141\x74\x65\x67\157\162\171\137\x69\144\x3d\x43\x2e\151\144\x20\141\156\x64\x20\123\103\x52\56\x73\x75\x62\x6a\x65\x63\x74\137\x69\144\x3d" . $row["\x69\x64"])->column("\x43\x2e\x6e\x61\x6d\145"); goto ITBd4; Nvkkp: $imageUrl = $row["\x69\155\141\147\145\x5f\x75\x72\x6c"]; goto QcIxe; myA8Y: xkoSo: goto DgblW; rMvbV: $row["\160\141\162\164\151\143\151\x70\141\x6e\164\x73"] = formatTimes($row["\160\x61\162\x74\151\x63\151\160\141\156\x74\x73"]); goto r9zU3; ITBd4: $row["\143\141\x74\x65\147\x6f\162\x79\137\x6e\x61\x6d\145\x73"] = $categoryNames; goto myA8Y; DgblW: } goto UNVbv; gjk2F: QUNew: goto UCrui; d79xw: $where["\123\56\x63\x75\162\162\145\156\164\137\160\x72\x69\x63\x65"] = 0; goto a0Tb7; ZSz0A: $rows = Db::table("\163\x75\142\x6a\145\x63\164")->alias("\x53")->where($where)->order("\x53\56\x73\x6f\162\x74\40\141\x73\143")->field("\123\56\151\x64\x2c\123\56\x6e\141\x6d\145\x2c\123\56\163\165\x62\x74\151\x74\154\x65\54\x53\56\x69\155\x61\x67\145\137\165\x72\154\54\x53\x2e\142\x61\156\x6e\x65\162\137\151\155\147\x2c\x53\56\x69\x74\145\x6d\x73\54\x53\x2e\x70\141\x72\x74\151\143\x69\160\141\x6e\x74\x73\x5f\163\x68\x6f\x77\x20\141\163\40\160\x61\162\x74\151\x63\x69\x70\x61\x6e\x74\x73\54\123\x2e\143\x75\162\162\145\x6e\x74\x5f\x70\x72\151\143\x65")->select(); goto TmyES; EyOq2: $rows = Db::table("\163\x75\x62\152\145\143\164")->alias("\x53")->join("\x73\x75\x62\x6a\x65\143\164\137\x63\141\164\145\x67\157\162\x79\x5f\162\x65\154\141\164\x65\x20\x53\x43\122", "\x53\56\x69\x64\75\x53\103\122\56\x73\165\x62\x6a\x65\143\164\x5f\151\144\40\141\x6e\x64\40\x53\x43\x52\56\143\x61\164\145\x67\157\162\171\x5f\x69\144\75" . $categoryId)->where($where)->order("\x53\x2e\163\x6f\162\164\40\141\x73\x63")->field("\123\x2e\151\144\x2c\123\x2e\156\141\155\145\x2c\123\56\163\x75\142\x74\x69\164\x6c\145\54\x53\56\151\x6d\141\147\145\137\x75\x72\x6c\54\123\x2e\142\x61\x6e\x6e\145\162\137\151\155\147\54\123\x2e\151\x74\145\x6d\163\x2c\123\56\160\x61\162\x74\151\143\151\160\141\156\164\163\137\163\150\x6f\167\x20\141\x73\40\x70\141\x72\x74\151\143\151\x70\141\156\x74\x73\54\123\x2e\143\x75\x72\162\145\x6e\164\x5f\160\x72\x69\x63\145")->select(); goto rwiV9; UNVbv: NigS3: goto dnFbw; yXhw0: if ($categoryId == -1) { goto wxZrZ; } goto EyOq2; nif2i: $where = ["\x53\56\x75\156\x69\x5f\141\160\x70" => 1]; goto EVFGl; TVzHI: wxZrZ: goto d79xw; K4laA: goto PVbDA; goto gjk2F; qPt_z: if ($categoryId == 0) { goto QUNew; } goto yXhw0; TmyES: PVbDA: goto Daytx; hvJoB: } public function getSubject($login_user_id, $id) { goto b4dse; yomwp: $record["\x74\145\141\155\x5f\142\162\x69\x65\x66"] = str_replace("\x53\111\124\x45\x5f\125\x52\114", SITE_URL, $record["\x74\x65\141\x6d\137\x62\x72\151\145\146"]); goto JvyrA; b4dse: $record = Db::table("\x73\x75\x62\152\145\143\164")->where(["\x69\x64" => $id])->field("\x69\x64\x2c\15\12\40\x20\40\x20\x20\x20\40\x20\40\40\40\x20\156\x61\x6d\145\x2c\15\12\40\40\40\x20\x20\40\x20\x20\40\40\40\x20\x73\165\142\x74\x69\x74\x6c\x65\x2c\15\12\x20\40\40\x20\40\40\40\x20\x20\40\40\40\143\165\x72\162\145\x6e\164\137\x70\162\x69\x63\x65\x2c\xd\12\x20\40\x20\40\x20\x20\40\40\40\40\40\40\145\170\160\x65\143\x74\137\x66\151\156\151\163\150\x5f\x74\x69\x6d\x65\54\15\xa\40\x20\x20\x20\40\x20\x20\40\x20\40\40\x20\x69\164\145\155\163\x2c\xd\xa\x20\40\40\40\x20\40\40\x20\40\40\40\x20\160\x61\x72\x74\151\143\151\160\141\156\164\163\x5f\x73\x68\x6f\x77\40\141\163\40\160\141\162\x74\x69\x63\x69\x70\x61\x6e\164\163\54\15\12\40\40\40\x20\x20\40\x20\40\40\x20\40\x20\163\165\142\x6a\x65\x63\164\x5f\x64\145\x73\x63\x2c\15\12\40\40\x20\x20\x20\40\x20\x20\x20\40\40\40\163\165\x62\152\145\143\164\137\164\x69\160\x2c\xd\xa\40\x20\40\x20\40\x20\40\40\x20\40\40\x20\151\x6d\x61\147\145\x5f\x75\162\x6c\x2c\15\12\40\x20\x20\40\40\40\40\x20\x20\40\x20\40\142\x61\156\156\145\x72\x5f\x69\x6d\147\54\xd\12\40\x20\x20\x20\x20\40\x20\x20\40\40\x20\x20\164\145\x73\164\137\x61\154\154\157\x77\137\x62\x61\x63\x6b\54\xd\12\40\x20\x20\x20\x20\40\x20\x20\x20\x20\40\x20\x74\145\x73\164\137\141\154\x6c\157\x77\137\x61\156\x73\167\145\162\137\x65\155\160\x74\171\54\xd\12\40\x20\40\x20\40\x20\x20\40\40\40\40\40\x72\x65\x70\157\x72\164\x5f\x64\x65\x6d\157\x5f\151\x6d\x61\147\145\x73")->find(); goto hcCVD; wY30G: $record["\x69\155\x61\147\x65\137\165\x72\154"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto aVtPR; q9OG0: Q2AAW: goto JOWpG; y101B: wexception("\xe6\227\240\xe6\263\x95\346\x89\276\345\x88\260\xe8\xaf\xa5\346\xb5\x8b\xe8\xaf\x84"); goto Eq0nT; JOWpG: $record["\163\x75\142\152\x65\x63\164\137\x74\x69\160"] = htmlspecialchars_decode($record["\163\165\x62\152\145\x63\x74\x5f\x74\151\x70"]); goto BATPC; Ow0a_: PFYKe: goto q9OG0; y633D: $record["\x70\x61\162\164\151\143\x69\x70\x61\156\164\163"] = formatTimes($record["\x70\141\162\164\151\x63\151\160\141\156\164\163"]); goto y07zz; H2eCL: $record["\157\162\x64\x65\x72\137\156\x6f"] = $lastOrder["\x6f\162\x64\145\162\137\156\x6f"]; goto Ow0a_; hcCVD: if ($record) { goto oSu3L; } goto y101B; gc8kT: if (!$login_user_id) { goto Q2AAW; } goto UDuD0; wyD9W: $imageUrl = $record["\x69\155\x61\x67\145\x5f\x75\x72\154"]; goto wY30G; LoRmJ: SafHZ: goto Tb9GE; JvyrA: $record["\x74\x65\x61\x6d\137\x62\162\151\x65\x66"] = nl2br($record["\x74\145\x61\x6d\137\142\162\x69\x65\146"]); goto U0xtm; xxE_2: $record["\163\165\142\x6a\x65\143\164\x5f\144\x65\x73\143"] = htmlspecialchars_decode($record["\x73\x75\x62\152\x65\x63\164\137\x64\145\163\x63"]); goto ODw5u; ODw5u: $record["\x73\165\x62\x6a\145\x63\164\x5f\144\145\163\x63"] = preg_replace("\x2f\74\x5b\151\x6d\147\174\x49\x4d\107\135\x2e\52\x3f\163\162\x63\x3d\x5b\47\174\x5c\42\x5d\50\56\x2a\x3f\51\x5b\x27\x7c\134\x22\x5d\x2f", "\74\151\x6d\x67\x20\163\162\x63\x3d\42" . SITE_URL . "\x24\x7b\61\175\42", $record["\163\165\142\152\145\143\164\x5f\x64\145\x73\x63"]); goto wyD9W; UDuD0: $lastOrder = Db::table("\x75\x6e\x69\137\141\x70\x70\137\157\162\x64\x65\162\163")->where(["\165\163\x65\162\137\x69\144" => $login_user_id, "\x73\x75\x62\152\145\143\164\137\151\x64" => $id, "\x66\x69\156\151\x73\x68\145\x64" => 0])->field("\157\x72\144\x65\x72\137\x6e\157")->find(); goto ab5PY; BATPC: $record["\164\145\141\155\137\142\x72\x69\x65\146"] = "\x3c\x70\x3e\344\270\x93\xe4\270\232\xe5\277\x83\347\220\206\346\xb5\213\xe8\xaf\x84\xe7\xa0\224\xe5\x8f\x91\345\x9b\242\xe9\230\x9f\xef\274\214\350\201\232\351\233\206\345\233\xbd\xe5\x86\x85\xe4\xbc\230\347\xa7\200\347\232\204\345\277\203\xe7\220\206\345\xad\246\347\xa1\x95\345\243\253\345\x8f\212\xe4\xbb\xa5\344\270\x8a\344\272\272\xe6\x89\215\54\xe5\205\xa8\xe9\235\242\xe6\xb6\xb5\xe7\x9b\x96\345\xa9\232\345\247\273\346\203\x85\346\204\237\xe3\x80\201\346\x83\x85\347\xbb\252\xe5\216\213\345\x8a\x9b\343\x80\x81\344\272\272\xe9\x99\205\xe5\x85\xb3\xe7\263\xbb\xe3\x80\201\344\272\xb2\345\255\220\xe6\225\231\350\202\xb2\xe3\200\x81\xe8\201\x8c\344\270\232\xe5\x8f\221\xe5\261\225\xe3\x80\201\344\xb8\252\344\272\xba\xe6\x88\x90\351\x95\xbf\xe7\255\x89\xe5\244\232\351\xa2\x86\xe5\237\x9f\347\232\204\345\277\203\xe7\220\206\346\265\x8b\350\257\x84\xe7\xa0\224\xe5\x8f\x91\xe3\x80\x82\xe6\227\240\xe8\xae\xba\xe4\275\240\345\x86\x85\xe5\277\x83\345\xad\x98\345\x9c\250\344\xbb\x80\344\xb9\x88\xe6\240\xb7\347\232\204\xe5\x9b\xb0\346\x83\221\357\xbc\214\xe9\x80\x9a\350\xbf\207\xe6\265\213\xe8\xaf\204\xe9\203\xbd\xe5\217\257\344\273\xa5\346\211\xbe\345\210\xb0\347\255\224\xe6\241\x88\343\200\x82\74\57\160\x3e\15\xa\x3c\160\76\x3c\x69\155\x67\40\163\x72\x63\75\x22\123\111\124\x45\137\125\122\114\x2f\163\164\x61\164\151\143\57\x69\155\x67\57\142\141\x6e\156\145\162\x2e\152\x70\147\x22\40\x73\x74\171\154\x65\x3d\x22\155\x61\x78\55\167\x69\144\164\x68\x3a\x31\x30\60\45\73\42\76\74\x2f\x70\76"; goto yomwp; ypQCP: foreach ($record["\162\145\160\x6f\162\164\137\144\x65\155\157\x5f\x69\155\x61\x67\145\163"] as $index => $image) { $record["\162\x65\160\x6f\x72\x74\137\x64\145\x6d\157\x5f\x69\155\141\147\145\x73"][$index] = generateUploadFullUrl($image); eByBn: } goto LoRmJ; aVtPR: $record["\142\x61\156\x6e\x65\x72\x5f\151\155\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto y633D; Eq0nT: oSu3L: goto xxE_2; Tb9GE: return $record; goto SmIaB; y07zz: $record["\157\x72\144\145\x72\137\156\157"] = ''; goto gc8kT; U0xtm: $record["\162\x65\160\157\162\164\x5f\144\145\x6d\157\x5f\x69\155\141\x67\145\163"] = $record["\162\x65\160\157\x72\x74\137\144\x65\155\157\x5f\151\155\x61\x67\145\163"] ? explode("\54", $record["\162\x65\160\x6f\162\x74\x5f\144\145\x6d\157\137\x69\x6d\x61\147\x65\x73"]) : []; goto ypQCP; ab5PY: if (!$lastOrder) { goto PFYKe; } goto H2eCL; SmIaB: } protected function getOrderByNo($order_no) { goto D4L8q; D4L8q: if (!empty($order_no)) { goto A18ll; } goto Wgu6I; VjEL3: NHQTJ: goto JuXh7; Mru2m: Log::error("\146\x61\151\x6c\145\144\x20\x74\x6f\40\x64\145\x63\157\x64\x65\x20\162\145\x73\x75\154\x74\x20\146\157\x72\40\x73\x75\x62\x6a\145\143\164\x20\x6f\162\144\x65\x72\72\x20{$order_no}"); goto E1Pyt; eYFH3: return $row; goto sNaxR; yIEKz: if ($result && isset($result["\x72\x65\x70\157\x72\x74\x4c\151\163\x74"])) { goto sNOzw; } goto Mru2m; qDl3N: goto NHQTJ; goto GBFiI; E1Pyt: $row["\x72\145\x70\157\162\x74\137\154\151\x73\x74"] = []; goto qDl3N; Wgu6I: return []; goto SmBSS; GBFiI: sNOzw: goto b737H; mJCI_: $result = json_decode($row["\162\145\163\165\x6c\x74"], true); goto yIEKz; zJss9: if (!($row && !empty($row["\162\145\163\x75\x6c\164"]))) { goto y7_OV; } goto mJCI_; SmBSS: A18ll: goto E_fMg; E_fMg: $row = Db::table("\x75\x6e\x69\x5f\141\x70\x70\x5f\x6f\162\x64\x65\162\163")->where(["\157\x72\x64\x65\x72\137\156\x6f" => $order_no])->field("\x2a")->find(); goto zJss9; JuXh7: y7_OV: goto eYFH3; b737H: $row["\162\x65\x70\157\x72\164\x5f\154\151\x73\164"] = $result["\162\145\x70\x6f\162\x74\114\151\163\164"]; goto VjEL3; sNaxR: } public function createOrder($login_user_id, $id, $order_no) { goto wA5Vu; ly7My: wexception("\xe6\x97\240\xe6\263\x95\xe6\211\xbe\345\x88\xb0\350\257\xa5\xe6\265\x8b\xe8\xaf\204\xe9\x87\x8f\350\xa1\xa8"); goto FvCXk; wA5Vu: $subject = Db::table("\163\165\142\x6a\145\143\164")->where(["\x69\144" => $id])->field("\x2a")->find(); goto mO84o; D26UB: GL1zo: goto husa5; aSDdx: $order = ["\157\162\144\x65\162\137\156\x6f" => $row["\x6f\162\144\145\162\x5f\156\157"], "\165\x73\x65\162\x5f\151\x64" => $row["\x75\163\x65\x72\137\x69\144"], "\x73\x75\x62\152\x65\x63\164\137\x69\x64" => $row["\x73\x75\142\x6a\145\x63\164\137\151\x64"], "\x6f\162\144\145\x72\137\141\155\x6f\x75\x6e\164" => $row["\157\162\x64\x65\x72\137\141\155\x6f\165\156\x74"], "\157\x72\x64\x65\x72\137\164\x69\x6d\x65" => $row["\157\162\x64\145\x72\x5f\164\x69\x6d\145"], "\164\x6f\x74\141\x6c\137\x69\x74\x65\x6d\163" => $row["\x74\x6f\x74\141\x6c\137\x69\x74\x65\155\163"], "\160\x61\x79\x5f\163\x74\141\164\165\x73" => $row["\x70\141\x79\x5f\x73\164\x61\164\x75\x73"]]; goto D26UB; YS_q2: $res = Db::table("\165\x6e\151\137\x61\160\160\x5f\x6f\162\144\x65\162\x73")->insert($order); goto T3q31; U628w: if (!($subject["\151\x74\x65\x6d\163"] == 0)) { goto r5pXf; } goto JM7C8; VWsOs: cnWgU: goto xFkGn; kvv03: goto GL1zo; goto VWsOs; xFkGn: $row = $this->getOrderByNo($order_no); goto FQbVw; husa5: return $order["\x6f\162\x64\145\x72\x5f\156\x6f"]; goto E9Ciy; FQbVw: if (!empty($row)) { goto h3uci; } goto RyS5p; pmnHI: h3uci: goto aSDdx; hp0kl: GVprT: goto kvv03; tb_cD: wexception("\xe6\225\xb0\346\x8d\256\345\xba\223\xe9\x94\x99\xe8\257\257"); goto hp0kl; mO84o: if (!empty($subject)) { goto N7hAK; } goto ly7My; RyS5p: wexception("\346\227\xa0\346\xb3\x95\346\211\xbe\xe5\210\260\xe8\xaf\xa5\xe8\xae\242\345\215\x95"); goto pmnHI; JM7C8: wexception("\346\xb5\x8b\xe8\257\x84\xe9\x87\x8f\350\xa1\xa8\xe5\x8c\205\xe5\x90\xab\xe7\x9a\x84\351\xa2\x98\xe7\x9b\256\xe4\270\xba\347\xa9\272"); goto WvmkJ; BW3tT: $order = ["\x6f\x72\x64\145\x72\x5f\156\157" => "\125\116\x49" . date("\171\x6d\144\x48\151\163") . $login_user_id, "\165\163\x65\162\137\151\144" => $login_user_id, "\163\165\142\152\145\x63\x74\137\151\144" => $id, "\x6f\x72\x64\145\162\137\x61\x6d\x6f\x75\x6e\164" => $subject["\x63\x75\x72\x72\x65\156\x74\x5f\160\x72\151\143\x65"], "\x6f\162\144\145\x72\137\164\x69\x6d\145" => date("\x59\x2d\155\55\144\x20\110\72\151\72\163"), "\x74\x6f\x74\x61\x6c\137\151\x74\x65\155\163" => $subject["\151\164\145\155\163"], "\160\141\x79\137\x73\164\x61\x74\165\x73" => $subject["\143\165\x72\162\145\156\x74\x5f\x70\162\151\143\x65"] > 0 ? Defs::PAY_WAIT : Defs::PAY_SUCCESS, "\x69\x74\x65\x6d\x5f\166\145\162\x73\x69\x6f\x6e" => $subject["\x69\164\x65\155\137\x76\x65\x72\x73\151\157\x6e"]]; goto YS_q2; WvmkJ: r5pXf: goto h23SD; T3q31: if (!empty($res)) { goto GVprT; } goto tb_cD; h23SD: if ($order_no) { goto cnWgU; } goto BW3tT; FvCXk: N7hAK: goto U628w; E9Ciy: } public function regenOrder($order_no) { goto aLO2I; XPavD: $order["\151\164\145\x6d\163"] = ''; goto fqR6V; MCfCQ: $order["\x74\157\164\141\154\x5f\151\164\x65\155\x73"] = $subject["\x69\164\x65\x6d\163"]; goto wgrt8; kDFnV: sgzF_: goto SyuZ1; mVxPB: wexception("\xe6\265\213\350\xaf\x84\344\270\215\xe5\255\x98\xe5\234\250"); goto u1Oq8; fqR6V: $order["\x72\x65\x73\165\x6c\x74"] = null; goto i9xOh; m0j6W: if (!empty($order)) { goto sgzF_; } goto dWrPn; Kd_BT: $order = []; goto MCfCQ; BZmRC: $order["\x69\164\x65\x6d\137\166\145\162\163\151\157\x6e"] = $subject["\151\x74\x65\x6d\x5f\166\x65\x72\x73\x69\x6f\156"]; goto PvQcC; PvYlK: if (!empty($subject)) { goto D6ggC; } goto mVxPB; SyuZ1: $subject = Db::table("\x73\165\142\152\145\x63\164")->where(["\151\x64" => $order["\163\165\142\x6a\145\x63\164\x5f\x69\144"]])->field("\x2a")->find(); goto PvYlK; dWrPn: wexception("\xe6\xb5\x8b\xe8\xaf\x84\350\xae\xa2\xe5\x8d\x95\xe4\270\215\345\255\x98\xe5\x9c\250\xef\xbc\232" . $order_no); goto kDFnV; aLO2I: $order = $this->getOrderByNo($order_no); goto m0j6W; wgrt8: $order["\164\145\163\x74\x5f\x69\x74\145\155\x73"] = 0; goto gQ9OV; u1Oq8: D6ggC: goto Kd_BT; gQ9OV: $order["\x63\x75\162\162\137\151\164\x65\x6d"] = 0; goto XPavD; PvQcC: Db::table("\165\x6e\151\x5f\x61\160\160\x5f\157\x72\x64\x65\162\x73")->where("\x6f\x72\x64\x65\x72\137\x6e\157", $order_no)->update($order); goto pSnlj; i9xOh: $order["\x66\x69\156\151\x73\150\145\x64"] = 0; goto BZmRC; pSnlj: } public function makeTestSubjectItems($items, $subjectItems) { goto V7BGq; D8V6p: $itemExists = explode("\x2c", $items); goto p3HjW; iunAZ: foreach ($subjectItems as $key => $item) { goto rLyi0; VPkOf: TgXd6: goto Am7lW; mKcpy: $index++; goto VPkOf; Sacm8: OBK5U: goto HRTNO; TMdqX: $item["\160\x72\x65\166\137\151\x64"] = "\151\144\137" . $item["\x70\x72\145\x76\137\x69\x64"]; goto PeC5g; E6oOI: if (!($index < count($subjectItems) - 1)) { goto OBK5U; } goto xqL12; rLyi0: if (!($index > 0)) { goto CiX09; } goto TMdqX; xqL12: $item["\x6e\x65\170\164\x5f\151\144"] = "\151\144\137" . $item["\156\145\x78\164\137\151\144"]; goto Sacm8; PeC5g: CiX09: goto E6oOI; HRTNO: $subjectItemsClone["\x69\144\x5f" . $key] = $item; goto mKcpy; Am7lW: } goto NbwaB; uoDX5: Gf6iT: goto GQ9Do; GQ9Do: wXTpT: goto c2du3; TPIaA: nSM7c: goto dr20r; CzH9x: return $subjectItemsClone; goto gBu21; L94lZ: $subjectItemsExist = []; goto D8V6p; NbwaB: UfmIs: goto CzH9x; c2du3: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto ojpam; Atth_: if (!$subjectItem[$imageField]) { goto jXAYq; } goto KvItd; ojpam: if (!$subjectItem["\x69\x6d\141\147\145"]) { goto u8tAa; } goto wKJ5a; qu34w: vZv5I: goto t81v3; w8zne: oLvSY: goto Z0sqS; t81v3: if (!($optionIndex <= 12)) { goto O_h5Y; } goto S1T22; fHHNP: u8tAa: goto JauRq; Dpymx: $optionIndex++; goto Wliey; S1T22: $imageField = "\x69\x6d\x61\x67\145\x5f" . $optionIndex; goto Atth_; V2UJe: jXAYq: goto Dpymx; x2sBm: O_h5Y: goto w8zne; wKJ5a: $subjectItem["\x69\155\141\147\x65"] = generateUploadFullUrl(generateThumbnailUrl($subjectItem["\x69\155\141\147\x65"], 200)); goto fHHNP; KvItd: $subjectItem[$imageField] = generateUploadFullUrl(generateThumbnailUrl($subjectItem[$imageField], 100)); goto V2UJe; Wliey: goto vZv5I; goto x2sBm; JauRq: $optionIndex = 1; goto qu34w; Z0sqS: } goto TPIaA; p3HjW: foreach ($itemExists as $itemExist) { goto Hn9vH; mrmxx: $subjectItemsExist[$itemIdExist] = ["\164\171\x70\145" => $itemTypeExist, "\166\x61\x6c\165\x65" => $itemTypeExist == Defs::QUESTION_CHECKBOX ? explode("\x2d", $itemValueExist) : $itemValueExist]; goto AzStn; HyYpq: yzCCw: goto WwjyH; ffzYJ: $itemValueExist = $itemSections[2]; goto mrmxx; Llnbz: if (!(count($itemSections) != 3)) { goto yzCCw; } goto F3uLP; NvhVj: $itemTypeExist = $itemSections[1]; goto ffzYJ; Hn9vH: $itemSections = explode("\46", $itemExist); goto Llnbz; F3uLP: goto M1NQD; goto HyYpq; WwjyH: $itemIdExist = $itemSections[0]; goto NvhVj; AzStn: M1NQD: goto EKsme; EKsme: } goto vybJt; V7BGq: if (!$items) { goto wXTpT; } goto L94lZ; CkX43: $index = 0; goto iunAZ; vybJt: m26n4: goto f4B6_; dr20r: $subjectItemsClone = []; goto CkX43; f4B6_: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto OS8gV; JVlUr: InStm: goto ozvk0; ozvk0: mGwvA: goto TJduh; OS8gV: if (!(isset($subjectItemsExist[$subjectItemId]) && $subjectItem["\164\171\x70\x65"] == $subjectItemsExist[$subjectItemId]["\164\171\160\x65"])) { goto InStm; } goto h7jcZ; h7jcZ: $subjectItem["\x76\141\x6c\165\x65"] = $subjectItemsExist[$subjectItemId]["\x76\x61\x6c\x75\145"]; goto JVlUr; TJduh: } goto uoDX5; gBu21: } public function answer($order_no, $item_id, $item_type, $item_option) { try { goto uvkaf; YWyFn: KKzbP: goto KC2r_; wJv3G: $item_option = join("\x2d", $item_option); goto A7R8J; sjJJX: if ($order["\164\145\x73\x74\x5f\151\164\x65\x6d\163"] == "\x30") { goto zo9zZ; } goto zWYq3; DORTB: $item = $subjectItems[$item_id]; goto rSojF; t38x1: $item_option = str_replace("\x2c", "\73", $item_option); goto YPNXZ; dKKED: exception("\xe8\257\245\xe6\xb5\x8b\350\257\x84\xe8\xae\242\345\x8d\x95\xe5\205\xb3\xe8\x81\x94\351\x87\217\xe8\241\250\344\xb8\242\xe5\xa4\xb1\xef\xbc\x9a" . $order_no); goto P8hE6; V4vr_: exception("\346\265\213\xe8\xaf\x84\xe5\267\262\345\256\x8c\xe6\x88\x90"); goto aaJlQ; Tlizj: lBc_h: goto DfX0F; pqh36: $item_option = htmlspecialchars_decode($item_option); goto X_JLe; d4DQx: foreach ($itemExists as $itemExist) { goto DkwQL; cjixA: goto mKX8O; goto k_kWB; k_kWB: ddMJE: goto em6Rh; nw2KS: if (!($itemIdExist == $item_id)) { goto ddMJE; } goto cjixA; em6Rh: $answer[$itemIdExist] = $itemExist; goto tvR8P; tvR8P: Xvw_N: goto b73bG; DkwQL: $itemIdExist = explode("\x26", $itemExist)[0]; goto nw2KS; b73bG: } goto IotK5; aaJlQ: Be0pq: goto UPouv; thh2J: $update["\162\x65\163\165\154\x74"] = json_encode(["\162\x65\160\157\x72\x74\114\x69\163\164" => $result], JSON_UNESCAPED_UNICODE); goto RYf58; myU6s: rc9vm: goto YBVk2; ROWZp: exception("\xe6\227\240\xe6\xb3\x95\346\211\276\xe5\210\260\350\xaf\245\xe6\xb5\213\xe8\257\x84\xe8\256\xa2\xe5\215\x95"); goto myU6s; EpF1W: $subjectItems = Subjects::I()->getSubjectItems($order["\x73\165\142\152\x65\143\x74\137\x69\144"]); goto QtJ_A; Cw_An: exception("\351\x87\217\350\xa1\xa8\xe9\xa2\230\xe7\x9b\xae\344\270\215\xe5\255\x98\345\234\250"); goto Va2vZ; QbOIb: $update["\x74\x65\x73\164\x5f\151\164\x65\x6d\x73"] = count($answer) + 1; goto PWinS; Va2vZ: CeiDi: goto DORTB; Yptfu: if (!empty($subject)) { goto cxg4x; } goto dKKED; Ck_a_: if (!($order["\151\164\x65\155\x5f\166\145\162\x73\x69\157\156"] != $subject["\151\164\x65\155\137\x76\x65\x72\163\x69\x6f\x6e"])) { goto MXr1S; } goto eco23; A7R8J: MjxDp: goto KRJwY; p09ME: Db::table("\165\156\151\x5f\141\x70\160\137\157\x72\x64\x65\162\163")->where(["\x6f\x72\144\x65\x72\x5f\x6e\157" => $order_no])->update($update); goto wq2ZP; p4TRJ: x3ACX: goto fKvyV; VLPvx: $update["\164\x65\163\x74\137\151\x74\145\155\x73"] = 1; goto YWyFn; eco23: exception("\346\265\213\xe8\xaf\204\xe9\241\xb9\347\x9b\256\347\211\210\xe6\234\xac\xe5\217\221\xe7\224\237\344\272\x86\345\x8f\x98\346\233\xb4\357\274\x8c\351\234\200\350\xa6\x81\xe9\x87\x8d\346\226\xb0\xe6\xb5\x8b\350\xaf\204", -1); goto q84sg; F1k9t: if (!empty($order)) { goto rc9vm; } goto ROWZp; Fejtk: exception("\xe8\xaf\x84\346\xb5\213\xe9\xa2\x98\xe7\233\xae\344\xb8\215\345\255\230\xe5\x9c\250\357\274\x9a" . $item_id); goto Tlizj; Jhq19: c_BJK: goto TnY9n; LebzT: exception("\xe9\207\x8f\xe8\xa1\250\351\xa1\xb9\347\x9b\xae\xe4\xb8\x8d\345\255\x98\xe5\x9c\xa8"); goto Jhq19; q0A7M: $update["\x63\165\x72\x72\137\x69\164\145\155"] = $item_id; goto Bb43F; OhKKe: if (!empty($item["\156\x65\x78\164\x5f\151\144"])) { goto Xwc2A; } goto NkO4H; PglmH: $item_option = htmlspecialchars_decode($item_option); goto t38x1; WPCrI: $item_option = []; goto HfQbR; rSojF: if (!empty($item)) { goto lBc_h; } goto Fejtk; YBVk2: if (!$order["\x66\x69\x6e\151\x73\150\145\x64"]) { goto Be0pq; } goto V4vr_; p0vI0: if (!empty($item_option)) { goto JMEoT; } goto WPCrI; QtJ_A: if (!empty($subjectItems)) { goto c_BJK; } goto LebzT; NkO4H: $update["\x66\x69\156\151\163\x68\145\x64"] = 1; goto UH7Xt; RYf58: Xwc2A: goto p09ME; q84sg: MXr1S: goto EpF1W; AWZX8: if (!($item_type == Defs::QUESTION_CHECKBOX)) { goto MjxDp; } goto p0vI0; YPNXZ: $item_option = str_replace("\x26", "\x20", $item_option); goto hFNfa; zWYq3: $itemExists = explode("\54", $order["\151\x74\145\x6d\x73"]); goto d4DQx; ngt8Y: array_walk($result, function ($item) use(&$update) { goto qO_2i; EpOwb: $update["\x77\141\x72\x6e\151\x6e\147\x5f\154\145\166\x65\x6c"] = $item["\167\141\162\x6e\x69\x6e\147\137\x6c\145\x76\x65\x6c"]; goto A8Fiu; wg_z3: return; goto riSm8; qO_2i: if (isset($item["\x77\141\162\156\151\156\x67\137\x6c\x65\x76\145\154"])) { goto j7zke; } goto wg_z3; ih1u5: if (!($item["\167\x61\x72\x6e\151\156\147\x5f\154\x65\166\145\x6c"] > $update["\167\x61\162\x6e\151\156\x67\137\154\x65\166\x65\154"])) { goto VdLOv; } goto EpOwb; riSm8: j7zke: goto ih1u5; A8Fiu: VdLOv: goto Wk_M3; Wk_M3: }); goto thh2J; X2UQx: if (!is_string($item_option)) { goto oAYF1; } goto pqh36; PWinS: goto KKzbP; goto lYo2t; KRJwY: goto x3ACX; goto COsO3; uvkaf: $order = $this->getOrderByNo($order_no); goto F1k9t; X_JLe: $item_option = json_decode($item_option, true); goto kAsDh; KC2r_: if ($item_type == Defs::QUESTION_TEXT) { goto E1tcS; } goto AWZX8; UPouv: $subject = Subjects::I()->getSubjectById($order["\163\165\x62\152\145\x63\x74\137\x69\x64"]); goto Yptfu; kAsDh: oAYF1: goto wJv3G; hFNfa: $item_option = htmlspecialchars($item_option); goto p4TRJ; COsO3: E1tcS: goto PglmH; wq2ZP: $order = array_merge($order, $update); goto qMV2Y; Bb43F: $answer = []; goto sjJJX; fKvyV: $answer[$item_id] = $item_id . "\46" . $item_type . "\46" . $item_option; goto d450z; IotK5: mKX8O: goto QbOIb; d450z: $update["\x69\164\x65\x6d\163"] = join("\54", $answer); goto OhKKe; DfX0F: $update = []; goto q0A7M; P8hE6: cxg4x: goto Ck_a_; HfQbR: JMEoT: goto X2UQx; srtUr: $result = SubjectLogic::I()->generateTestResult($order["\163\x75\x62\152\145\143\x74\x5f\x69\144"], Subjects::I()->parseOrderItems($update["\x69\164\x65\155\x73"])); goto db8Lo; lYo2t: zo9zZ: goto VLPvx; db8Lo: $update["\167\141\x72\156\151\156\x67\137\x6c\145\x76\145\x6c"] = Defs::MEASURE_WARNING_UNKOWN_LEVEL; goto ngt8Y; UH7Xt: $update["\x66\x69\156\151\163\x68\x5f\x74\151\x6d\x65"] = date("\131\55\x6d\x2d\144\x20\x48\72\x69\x3a\163"); goto srtUr; TnY9n: if (isset($subjectItems[$item_id])) { goto CeiDi; } goto Cw_An; qMV2Y: } catch (\Exception $e) { goto JVw0v; FFseo: wexception("\346\265\213\xe8\257\204\xe9\241\271\xe7\233\256\xe7\x89\210\346\234\254\xe5\217\230\346\x9b\264", -1); goto WeRVJ; WeRVJ: piIqg: goto d8fLF; NjEld: if (!($exceptionCode == -1)) { goto piIqg; } goto FFseo; d8fLF: wexception($e->getMessage()); goto Wzgy6; JVw0v: $exceptionCode = $e->getCode(); goto NjEld; Wzgy6: } return ["\x66\151\156\151\x73\150\145\x64" => $order["\146\151\156\x69\163\150\x65\x64"]]; } }
