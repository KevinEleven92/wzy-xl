<?php
 namespace app\mp\logic; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\mp\service\Subjects; use app\Defs; use app\index\logic\Subject as SubjectLogic; use EasyWeChat\Factory; use app\index\service\EventLogs as EventLogsService; class UniApp extends Base { public function login($channel, $code = '') { goto fysDI; K1Cd2: tEVm6: goto Y0R7J; Qdu1l: $loginResult = $this->_loginBaidu($code); goto MrwH2; MrwH2: $openid = $loginResult["\157\160\145\x6e\151\144"]; goto TTgA2; Ld0YF: if (!$user["\x68\145\x61\x64\151\x6d\x67\137\165\162\154"]) { goto Q5Zrw; } goto BJVHQ; mM4U6: if ($channel == "\x57\105\x49\x58\x49\x4e") { goto tEVm6; } goto HjUF9; P0nTd: IRlHq: goto Yikup; dhhfh: if ($user) { goto Uu5xQ; } goto I4Rbc; d4TQW: YlDXs: goto vqtrS; Yikup: goto YlDXs; goto F_pW_; F_pW_: pEFUa: goto Qdu1l; TTgA2: $sessionKey = $loginResult["\163\145\163\163\x69\157\x6e\x5f\153\145\171"]; goto d4TQW; wW2MI: Uu5xQ: goto UFrkO; P9cDX: $sessionKey = "\x73\x65\163\163\x69\x6f\156\x5f\153\145\x79"; goto TK00s; SQc6K: DEJvz: goto IprH3; csSlR: $openid = $loginResult["\x6f\160\x65\156\x69\x64"]; goto ph0RX; wby6C: goto IRlHq; goto K1Cd2; IprH3: return ["\163\x65\x73\163\151\157\x6e\137\153\x65\171" => $sessionKey, "\x68\145\141\x64\x69\155\147\x5f\x75\x72\x6c" => $headimgUrl]; goto SelRo; ph0RX: $sessionKey = $loginResult["\x73\x65\163\x73\151\x6f\156\x5f\153\145\x79"]; goto P0nTd; Y0R7J: $loginResult = $this->_loginWeixin($code); goto csSlR; UFrkO: Db::table("\x75\x6e\x69\137\141\x70\x70\x5f\165\163\145\x72\x73")->where("\157\160\145\x6e\151\x64", $openid)->update(["\x73\x65\163\x73\x69\157\x6e\137\153\145\x79" => $sessionKey, "\x6c\x61\164\x65\x73\x74\137\x6c\157\147\151\x6e\137\164\151\x6d\145" => Db::raw("\x6e\157\167\x28\51")]); goto Ld0YF; I4Rbc: Db::table("\165\x6e\151\137\141\160\160\137\165\163\145\162\x73")->insert(["\x6f\160\145\x6e\151\x64" => $openid, "\x73\x65\163\163\151\157\x6e\x5f\x6b\145\x79" => $sessionKey, "\x72\x65\x67\x69\163\164\145\x72\137\164\x69\155\145" => Db::raw("\156\157\x77\50\51"), "\x6c\x61\x74\145\x73\164\x5f\154\x6f\x67\x69\x6e\x5f\x74\151\155\145" => Db::raw("\156\157\167\50\x29"), "\x63\150\x61\x6e\x6e\x65\x6c" => $channel]); goto Dog31; TK00s: $channel = "\110\65"; goto wby6C; vqtrS: $headimgUrl = generateUploadFullUrl("\x2f\x73\x74\x61\164\151\x63\57\151\155\x67\57\141\166\141\x74\x61\162\56\160\156\147"); goto bnRSi; BJVHQ: $headimgUrl = generateUploadFullUrl($user["\150\x65\x61\x64\151\155\147\137\x75\x72\x6c"]); goto DQNWy; HjUF9: $openid = "\x6f\160\145\156\151\x64"; goto P9cDX; DQNWy: Q5Zrw: goto SQc6K; Dog31: goto DEJvz; goto wW2MI; bnRSi: $user = Db::table("\165\x6e\x69\137\x61\x70\160\137\165\163\145\x72\163")->where("\157\160\145\x6e\x69\x64", $openid)->field(true)->find(); goto dhhfh; fysDI: if ($channel == "\102\x41\111\x44\x55") { goto pEFUa; } goto mM4U6; SelRo: } private function _loginBaidu($code) { goto TSvfm; PGcTl: exception("\346\227\xa0\346\xb3\x95\xe8\247\xa3\xe6\236\x90\157\160\x65\x6e\151\144\72\x20" . $output); goto cgHMd; iekJG: curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); goto Hu90U; nxaih: z4vtx: goto yK96y; Q8Qam: if (!($httpCode != "\x32\x30\x30")) { goto l3feu; } goto DVJTk; cgHMd: LWFw1: goto BVvZ0; Sq5Tr: $output = curl_exec($curl); goto Yf0_Y; Hu90U: curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); goto sJEnd; sWQxS: if (!empty($jsonObj)) { goto lLzFx; } goto NaLDg; z30sQ: $postDataArr = array("\x63\x6f\144\145" => $code, "\x63\x6c\151\x65\x6e\x74\137\x69\144" => "\167\111\107\65\101\x6f\161\152\x4c\x51\x64\x42\126\111\124\172\x59\164\130\x78\111\x78\x44\x44\105\60\161\x39\122\x47\102\x4e", "\163\x6b" => "\107\x51\x41\x38\x39\165\123\130\166\117\x46\x37\x57\x4c\x4c\x51\150\156\102\143\156\x6e\131\67\116\142\x31\x53\x4e\125\x77\144"); goto tp8LG; DVJTk: exception("\347\231\xbe\xe5\272\xa6\xe5\272\224\xe7\255\x94\150\164\164\160\x20\143\x6f\x64\145\x3a\40{$httpCode}"); goto BuIr7; Yf0_Y: if (!empty($output)) { goto z4vtx; } goto ZWzAq; yK96y: $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE); goto XQSsf; sJEnd: curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); goto Sq5Tr; MV51q: lLzFx: goto JH2vA; tp8LG: $headerArr = array("\103\157\x6e\x74\145\x6e\164\55\164\x79\x70\x65\x3a\141\160\160\x6c\151\x63\x61\164\x69\157\x6e\x2f\x78\55\167\167\167\x2d\146\157\162\155\x2d\165\162\154\145\156\x63\x6f\144\145\x64"); goto w9E3H; BuIr7: l3feu: goto J24rm; J24rm: Log::notice("\x62\141\x69\x64\x75\x20\x6f\141\x75\x74\150\40\162\145\163\x70\157\156\163\x65\72\40{$output}"); goto WLyVI; vmQKK: $sessionKey = $jsonObj["\x73\x65\x73\163\x69\157\156\137\153\x65\171"]; goto qyh15; Hl4AQ: $errMsg = curl_error($curl); goto qrC1V; XQSsf: curl_close($curl); goto Q8Qam; BVvZ0: $openid = $jsonObj["\x6f\160\x65\156\x69\x64"]; goto vmQKK; OlQBf: $url .= http_build_query($postDataArr); goto Ycxl9; NaLDg: exception("\346\x97\xa0\346\xb3\x95\xe8\247\243\346\x9e\x90\xe5\xba\x94\347\255\224\72\40" . $output); goto MV51q; ZWzAq: $errCode = curl_errno($curl); goto Hl4AQ; qyh15: return ["\157\160\145\x6e\x69\x64" => $openid, "\x73\145\163\x73\151\x6f\156\137\153\x65\171" => $sessionKey]; goto Ukb0F; TSvfm: $url = "\150\164\x74\x70\163\x3a\x2f\x2f\163\x70\x61\160\x69\56\142\x61\151\x64\x75\56\x63\157\155\x2f\157\141\x75\x74\x68\57\152\x73\143\x6f\144\x65\62\x73\x65\x73\x73\151\x6f\x6e\153\x65\171"; goto z30sQ; iFm6S: exception("\346\227\xa0\346\xb3\x95\xe8\216\267\345\xbe\227\xe7\231\xbe\xe5\xba\xa6\346\234\x8d\345\x8a\xa1\345\231\250\xe5\xba\x94\347\xad\x94\54\x20{$errCode}\40\x2d\40{$errMsg}"); goto nxaih; Ycxl9: Log::notice("\142\141\x69\144\x75\40\x6f\x61\165\164\x68\40\162\x65\161\x75\x65\x73\x74\x3a\40" . var_export($postDataArr, true)); goto dt58m; dt58m: $curl = curl_init(); goto dOjiq; JH2vA: if (isset($jsonObj["\157\x70\x65\156\151\x64"])) { goto LWFw1; } goto PGcTl; w9E3H: $url .= "\77"; goto OlQBf; WLyVI: $jsonObj = json_decode($output, true); goto sWQxS; dOjiq: curl_setopt($curl, CURLOPT_URL, $url); goto iekJG; qrC1V: curl_close($curl); goto iFm6S; Ukb0F: } private function _loginWeixin($code) { goto XQUKD; p88rO: return ["\x6f\160\x65\x6e\151\x64" => $openid, "\163\x65\163\x73\x69\157\x6e\x5f\x6b\145\171" => $sessionKey]; goto qBUtL; CqDtK: if (!(!isset($wxUser["\x6f\160\145\156\x69\144"]) || !isset($wxUser["\163\145\x73\163\151\x6f\x6e\x5f\x6b\145\171"]))) { goto EtN1f; } goto QVaUC; aC9za: $sessionKey = $wxUser["\x73\x65\163\x73\151\x6f\x6e\x5f\x6b\x65\171"]; goto p88rO; t1Fif: $openid = $wxUser["\x6f\x70\x65\x6e\x69\x64"]; goto aC9za; XQUKD: wxPaySetting(); goto E3nKP; smdZT: Log::notice("\x77\x65\x69\x78\151\x6e\x20\x6f\x61\x75\164\x68\x20\x72\145\163\x70\157\x6e\x73\145\x3a\40" . var_export($wxUser, true)); goto t1Fif; E3nKP: $app = Factory::miniProgram(config("\167\170\x2e\x6d\x69\156\x69\137\160\162\x6f\x67\x72\141\155")); goto WK2G5; WK2G5: $wxUser = $app->auth->session($code); goto RgPqQ; kGjZY: EtN1f: goto smdZT; RgPqQ: if ($wxUser) { goto NY156; } goto X2kWW; X2kWW: exception("\345\xbe\256\344\277\xa1\347\x99\xbb\345\xbd\x95\345\xba\224\xe7\xad\224\344\xb8\272\347\xa9\272"); goto NZ4sS; QVaUC: exception("\xe5\276\256\xe4\xbf\241\xe7\231\273\xe5\275\x95\345\244\261\xe8\264\xa5\x3a\40" . var_export($wxUser, true)); goto kGjZY; NZ4sS: NY156: goto CqDtK; qBUtL: } public function logout($session_key) { Db::table("\x75\x6e\x69\137\141\x70\160\137\165\x73\x65\162\163")->where("\163\145\x73\x73\151\x6f\x6e\x5f\153\145\x79", $session_key)->update(["\x73\x65\x73\163\x69\x6f\x6e\137\153\x65\x79" => '']); } public function subjectsPopular() { goto QXehB; uK5HA: YghIr: goto x12HI; QXehB: $rows = Db::query("\163\x65\154\145\143\x74\40\151\x64\54\x20\x6e\x61\x6d\145\54\40\x73\x75\142\x74\x69\164\154\x65\x2c\40\x69\x6d\x61\x67\x65\x5f\165\x72\x6c\54\x20\142\x61\156\x6e\145\x72\x5f\x69\x6d\x67\x2c\x20\151\x74\x65\155\x73\54\x20\160\x61\162\x74\x69\x63\x69\x70\x61\x6e\x74\163\x5f\x73\150\157\x77\40\x61\x73\40\160\141\162\x74\x69\143\151\160\141\156\x74\x73\x2c\40\x63\x75\162\x72\145\x6e\x74\137\160\x72\151\x63\145\x20\xd\xa\11\x9\11\x9\x9\x9\x9\146\x72\157\155\40\163\165\142\152\x65\143\x74\x20\15\xa\11\11\x9\x9\11\x9\x9\167\x68\145\162\x65\40\106\111\x4e\x44\137\x49\x4e\137\123\x45\124\50\x27\160\x6f\160\165\154\x61\x72\x27\54\40\x6c\141\x62\x65\154\x29\40\x61\x6e\x64\x20\144\145\x6c\145\x74\x65\x5f\x66\x6c\141\147\x3d\60\40\x61\x6e\144\x20\163\164\x61\x74\x75\x73\75" . IndexDefs::ENTITY_PUBLISH_STATUS . "\40\x61\x6e\144\x20\165\156\x69\x5f\141\x70\160\x3d\61\15\12\x9\x9\11\11\x9\x9\x9\x4f\x52\x44\x45\122\x20\x42\131\40\122\101\116\x44\x28\x29\40\114\x49\x4d\111\x54\x20\x34"); goto OMRoy; x12HI: return $rows; goto UGbsb; OMRoy: foreach ($rows as &$row) { goto MSSdD; j1yWW: bQFRM: goto pflAC; kPHD4: $row["\143\141\164\145\147\x6f\162\171\137\x6e\141\x6d\x65\x73"] = $categoryNames; goto j1yWW; CnmF3: $row["\160\x61\162\x74\x69\x63\x69\160\x61\x6e\x74\163"] = formatTimes($row["\160\141\x72\164\151\143\x69\160\141\156\164\163"]); goto rTkc4; rTkc4: $categoryNames = Db::table("\x73\x75\x62\x6a\145\143\164\x5f\x63\141\x74\x65\147\x6f\162\x79\x5f\x72\145\x6c\141\x74\x65")->alias("\123\103\122")->join("\143\x61\164\145\x67\x6f\x72\151\x65\x73\40\x43", "\123\x43\x52\x2e\143\x61\x74\145\147\157\162\x79\x5f\x69\x64\x3d\103\56\151\x64\40\x61\x6e\x64\40\123\x43\x52\56\x73\165\x62\152\145\x63\x74\x5f\x69\144\x3d" . $row["\x69\144"])->column("\103\56\156\141\x6d\145"); goto kPHD4; l9DqS: $row["\142\x61\x6e\156\x65\x72\137\x69\155\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto CnmF3; MSSdD: $imageUrl = $row["\x69\x6d\x61\x67\145\x5f\x75\x72\154"]; goto Xr5GQ; Xr5GQ: $row["\x69\x6d\x61\x67\145\x5f\165\162\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto l9DqS; pflAC: } goto uK5HA; UGbsb: } public function subjectsFeatured() { goto f9ds2; A2pyH: return $rows; goto GoJ89; f9ds2: $rows = Db::query("\163\145\x6c\145\143\164\x20\151\144\x2c\40\x6e\141\x6d\x65\54\x20\x73\165\142\x74\151\x74\154\145\x2c\40\x69\x6d\141\147\145\137\x75\162\x6c\x2c\x20\x62\x61\156\156\x65\x72\x5f\x69\155\x67\54\x20\x69\x74\x65\155\x73\x2c\40\160\141\162\x74\151\x63\151\160\141\x6e\x74\163\137\163\x68\157\167\40\x61\x73\40\160\x61\x72\164\x69\x63\151\160\141\x6e\164\x73\54\40\x63\x75\x72\x72\x65\156\x74\137\x70\162\x69\x63\145\40\xd\12\x9\11\x9\x9\11\x9\x9\146\x72\157\x6d\40\163\165\x62\x6a\x65\x63\x74\40\15\xa\11\11\x9\x9\11\11\x9\x77\x68\145\x72\x65\40\106\111\x4e\104\137\111\x4e\x5f\123\105\124\50\x27\x66\x65\x61\164\165\162\x65\x64\x27\54\40\154\x61\142\x65\154\51\40\141\156\144\40\144\x65\154\145\x74\145\137\x66\154\x61\x67\75\x30\x20\141\156\144\x20\163\x74\x61\164\x75\x73\x3d" . IndexDefs::ENTITY_PUBLISH_STATUS . "\40\x61\x6e\x64\x20\165\156\x69\137\x61\160\x70\x3d\61\15\xa\11\x9\x9\x9\x9\x9\x9\157\162\144\145\x72\40\142\x79\x20\163\x6f\x72\x74\40\141\x73\x63"); goto InSx7; InSx7: foreach ($rows as &$row) { goto g1sFm; nvtHY: $row["\142\141\156\x6e\145\x72\x5f\x69\x6d\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto Uf7b8; g1sFm: $imageUrl = $row["\151\155\141\x67\x65\x5f\165\x72\154"]; goto H0hEL; vA6Js: rNDOg: goto ysua9; H0hEL: $row["\151\155\x61\147\x65\x5f\x75\x72\154"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto nvtHY; Uf7b8: $row["\x70\141\162\x74\151\x63\151\x70\x61\x6e\x74\x73"] = formatTimes($row["\160\141\162\164\151\x63\151\160\141\x6e\x74\x73"]); goto j_NR6; j_NR6: $categoryNames = Db::table("\x73\x75\x62\152\145\x63\164\x5f\x63\141\x74\145\147\157\x72\171\x5f\x72\145\x6c\141\x74\145")->alias("\123\x43\x52")->join("\143\141\x74\x65\x67\157\162\x69\145\163\x20\103", "\x53\103\x52\56\143\x61\x74\x65\x67\157\x72\x79\137\x69\144\75\103\x2e\x69\144\40\141\156\x64\x20\x53\x43\122\x2e\163\165\x62\152\145\143\x74\137\x69\x64\x3d" . $row["\151\x64"])->column("\103\56\156\141\x6d\145"); goto EGNF5; EGNF5: $row["\143\141\164\145\147\x6f\162\171\x5f\156\141\x6d\x65\x73"] = $categoryNames; goto vA6Js; ysua9: } goto zk0Mf; zk0Mf: wTwh5: goto A2pyH; GoJ89: } public function subjectsInCategory($categoryId, $kw) { goto SbAfU; Ah9An: if ($categoryId == 0) { goto U6VFW; } goto s23Lv; SbAfU: $where = ["\123\56\x75\x6e\x69\x5f\141\160\160" => 1]; goto dznux; CDGhh: $rows = Db::table("\163\165\142\x6a\145\x63\x74")->alias("\123")->join("\163\x75\x62\x6a\x65\143\x74\x5f\143\x61\164\x65\x67\157\162\171\137\x72\x65\x6c\141\x74\145\40\123\x43\x52", "\x53\56\151\144\x3d\123\x43\122\56\163\x75\142\x6a\145\143\164\x5f\151\144\x20\x61\156\x64\x20\x53\103\x52\56\x63\141\164\x65\147\157\162\x79\137\151\x64\75" . $categoryId)->where($where)->order("\123\x2e\163\x6f\x72\x74\x20\x61\x73\x63")->field("\123\x2e\151\144\x2c\123\56\156\x61\155\145\54\x53\x2e\x73\165\x62\164\x69\x74\154\x65\54\x53\x2e\x69\155\x61\147\x65\137\165\162\154\54\123\x2e\x62\x61\x6e\156\145\x72\137\151\155\x67\54\x53\56\x69\x74\145\x6d\x73\x2c\123\56\160\141\162\164\x69\143\151\x70\141\156\x74\163\x5f\x73\150\x6f\x77\x20\141\163\x20\160\x61\162\x74\x69\x63\x69\x70\141\156\x74\x73\54\x53\56\143\x75\162\162\x65\x6e\164\x5f\x70\x72\x69\x63\x65")->select(); goto dlb57; s23Lv: if ($categoryId == -1) { goto bF1xJ; } goto CDGhh; dznux: $where["\123\56\144\145\154\x65\x74\145\x5f\146\x6c\141\x67"] = 0; goto HJycT; WBrZL: ula5x: goto Xibyp; l2a1W: return $rows; goto LgaZG; a_jQx: $rows = Db::table("\x73\165\142\x6a\x65\x63\164")->alias("\x53")->where($where)->order("\123\56\x73\x6f\x72\164\40\141\163\143")->field("\x53\x2e\151\144\x2c\x53\x2e\156\x61\155\x65\x2c\x53\56\163\165\142\x74\151\164\154\145\54\123\x2e\x69\x6d\141\x67\x65\137\x75\162\x6c\54\x53\x2e\x62\x61\156\156\x65\162\137\x69\155\147\x2c\x53\x2e\x69\x74\x65\x6d\163\x2c\123\56\160\x61\162\x74\151\143\x69\160\141\x6e\x74\x73\137\163\x68\x6f\167\x20\x61\x73\40\160\x61\162\x74\151\143\x69\x70\x61\156\164\x73\54\x53\x2e\143\165\162\162\x65\156\164\x5f\160\162\x69\143\x65")->select(); goto WBrZL; AUQDT: bF1xJ: goto HS9lz; dlb57: goto CXWxn; goto AUQDT; HJycT: $where["\x53\x2e\163\x74\141\x74\165\163"] = ["\x69\x6e", [IndexDefs::ENTITY_PUBLISH_STATUS]]; goto Ah9An; Q5nUp: U6VFW: goto B4sRg; Xibyp: foreach ($rows as &$row) { goto ISKPw; u9gFO: $row["\x70\x61\x72\x74\x69\x63\x69\160\x61\156\164\x73"] = formatTimes($row["\x70\141\162\x74\151\143\x69\160\x61\x6e\x74\x73"]); goto bTS8s; b864f: $row["\x62\141\156\156\x65\162\x5f\x69\155\147"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 280)); goto u9gFO; ISKPw: $imageUrl = $row["\151\155\x61\x67\x65\137\165\162\x6c"]; goto Btmg4; bTS8s: $categoryNames = Db::table("\x73\x75\x62\x6a\x65\143\x74\x5f\x63\141\164\x65\147\x6f\162\171\137\x72\145\154\141\164\145")->alias("\123\x43\122")->join("\x63\x61\x74\x65\x67\x6f\x72\x69\x65\x73\x20\x43", "\x53\103\122\56\x63\x61\x74\x65\x67\x6f\162\x79\137\x69\x64\x3d\x43\x2e\151\144\40\x61\x6e\x64\40\123\x43\x52\56\x73\165\x62\152\145\x63\164\x5f\151\144\75" . $row["\151\x64"])->column("\103\x2e\x6e\141\155\x65"); goto PtwUR; Btmg4: $row["\151\x6d\x61\x67\145\137\165\162\x6c"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 300)); goto b864f; ol7Ei: n4YFp: goto deu96; PtwUR: $row["\143\x61\164\x65\x67\x6f\x72\171\137\156\x61\155\x65\x73"] = $categoryNames; goto ol7Ei; deu96: } goto LtrvO; EPta3: $where["\x53\56\156\141\x6d\x65"] = ["\154\x69\153\x65", "\x25" . $kw . "\x25"]; goto gdrSb; B4sRg: if (!$kw) { goto jyj7R; } goto EPta3; vis3G: goto ula5x; goto Q5nUp; Lmmxv: $rows = Db::table("\x73\x75\x62\152\x65\143\x74")->alias("\x53")->where($where)->order("\123\56\x73\x6f\x72\x74\x20\x61\163\143")->field("\123\56\x69\x64\54\x53\x2e\156\141\155\x65\x2c\123\56\x73\165\x62\164\x69\164\x6c\x65\x2c\x53\56\x69\155\141\x67\145\x5f\165\162\x6c\x2c\123\x2e\142\141\x6e\x6e\145\162\x5f\x69\155\x67\54\123\x2e\151\x74\145\155\x73\54\x53\x2e\x70\x61\x72\164\x69\x63\x69\160\x61\156\x74\x73\137\163\x68\x6f\x77\x20\x61\x73\x20\160\x61\162\164\151\x63\x69\160\141\156\164\x73\x2c\x53\56\x63\x75\162\x72\145\x6e\x74\137\x70\162\x69\x63\145")->select(); goto gNRc3; HS9lz: $where["\123\x2e\143\x75\162\x72\145\156\x74\x5f\x70\162\151\x63\145"] = 0; goto Lmmxv; LtrvO: hT5wc: goto l2a1W; gNRc3: CXWxn: goto vis3G; gdrSb: jyj7R: goto a_jQx; LgaZG: } public function getSubject($login_user_id, $id) { goto bgPwu; msLJp: wexception("\346\227\xa0\xe6\xb3\225\xe6\211\276\345\210\260\350\xaf\xa5\xe6\265\x8b\350\xaf\x84"); goto TQ6Bc; R6kfE: return $record; goto qqXJ8; dNonp: $record["\x73\165\142\152\145\143\x74\x5f\164\151\160"] = htmlspecialchars_decode($record["\x73\165\142\x6a\145\143\x74\x5f\164\x69\x70"]); goto vpuDA; yIX8n: $lastOrder = Db::table("\x75\x6e\x69\x5f\141\x70\160\137\157\162\x64\x65\x72\x73")->where(["\x75\163\145\x72\137\151\x64" => $login_user_id, "\163\x75\x62\152\145\143\x74\x5f\x69\144" => $id, "\x66\x69\156\151\163\150\x65\144" => 0])->field("\157\x72\144\145\x72\137\156\157")->find(); goto hh94m; hh94m: if (!$lastOrder) { goto nwwM9; } goto b44hU; IDrv3: nwwM9: goto JW6R4; DigY9: $record["\x69\155\141\x67\x65\137\165\x72\154"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto LVErh; i9CCk: $imageUrl = $record["\151\155\141\147\145\x5f\165\x72\154"]; goto DigY9; dK9Sy: foreach ($record["\x72\x65\160\157\x72\164\x5f\144\145\x6d\157\x5f\151\x6d\141\x67\145\163"] as $index => $image) { $record["\x72\x65\x70\157\x72\x74\137\x64\145\x6d\157\x5f\x69\155\x61\147\145\163"][$index] = generateUploadFullUrl($image); x_Nnf: } goto fS2f9; NQhwd: $record["\x74\x65\141\x6d\x5f\142\162\151\x65\146"] = nl2br($record["\164\145\141\155\137\x62\162\x69\145\146"]); goto dqaNy; fkXxj: $record["\163\x75\142\152\145\x63\x74\x5f\144\x65\x73\x63"] = preg_replace("\x2f\x3c\x5b\x69\x6d\147\x7c\111\115\x47\x5d\x2e\x2a\77\163\162\x63\75\x5b\x27\174\134\x22\135\x28\56\52\x3f\51\133\47\x7c\134\42\x5d\x2f", "\x3c\151\x6d\147\40\x73\162\x63\x3d\x22" . SITE_URL . "\x24\x7b\x31\x7d\x22", $record["\x73\165\142\152\x65\x63\164\x5f\x64\x65\x73\x63"]); goto i9CCk; b44hU: $record["\x6f\x72\x64\145\162\x5f\156\x6f"] = $lastOrder["\x6f\x72\x64\145\162\x5f\156\x6f"]; goto IDrv3; sF2eq: $record["\164\x65\x61\155\137\142\x72\x69\145\146"] = str_replace("\123\x49\124\105\137\x55\122\x4c", SITE_URL, $record["\x74\x65\141\x6d\137\x62\162\x69\145\x66"]); goto NQhwd; q9Dds: $record["\x73\165\x62\x6a\x65\143\x74\137\x64\145\x73\x63"] = htmlspecialchars_decode($record["\163\x75\x62\152\x65\143\x74\137\144\145\163\143"]); goto fkXxj; mZeNb: if (!$login_user_id) { goto b364u; } goto yIX8n; Z4aMt: if ($record) { goto OfdvV; } goto msLJp; dqaNy: $record["\x72\x65\x70\157\162\164\137\x64\x65\x6d\157\137\x69\x6d\x61\147\145\163"] = $record["\162\x65\x70\x6f\x72\x74\x5f\144\x65\155\157\x5f\151\x6d\x61\147\145\x73"] ? explode("\54", $record["\x72\145\x70\157\x72\164\x5f\x64\x65\155\157\137\151\155\141\147\x65\163"]) : []; goto dK9Sy; oAbud: $record["\160\x61\x72\164\x69\x63\151\160\141\156\164\x73"] = formatTimes($record["\160\x61\162\x74\151\x63\151\x70\141\156\164\x73"]); goto GcSrW; fS2f9: ruM1A: goto R6kfE; JW6R4: b364u: goto dNonp; vpuDA: $record["\x74\x65\x61\x6d\137\142\x72\x69\145\146"] = "\x3c\160\76\xe4\270\223\344\270\x9a\xe5\277\203\347\x90\x86\346\265\213\xe8\xaf\x84\347\240\x94\xe5\217\221\345\233\242\xe9\x98\x9f\xef\xbc\x8c\350\201\x9a\xe9\x9b\206\xe5\x9b\xbd\xe5\x86\205\xe4\xbc\x98\347\xa7\x80\347\x9a\204\345\277\203\xe7\x90\206\xe5\xad\xa6\347\xa1\x95\xe5\xa3\xab\xe5\x8f\x8a\344\273\xa5\xe4\xb8\212\xe4\xba\272\xe6\x89\215\x2c\xe5\x85\250\351\x9d\xa2\346\xb6\xb5\xe7\233\x96\xe5\xa9\232\345\xa7\273\346\203\205\xe6\204\x9f\xe3\200\x81\xe6\203\205\xe7\xbb\252\xe5\x8e\213\345\x8a\x9b\343\x80\201\xe4\272\xba\xe9\x99\x85\xe5\205\263\347\263\xbb\343\200\x81\344\xba\xb2\xe5\255\x90\xe6\225\231\350\x82\xb2\xe3\200\x81\xe8\201\214\xe4\270\x9a\xe5\x8f\221\345\261\x95\xe3\x80\201\xe4\xb8\252\344\272\272\346\x88\x90\xe9\225\277\347\xad\x89\345\244\232\351\xa2\x86\345\237\237\347\x9a\204\345\xbf\203\xe7\220\206\xe6\xb5\213\350\xaf\x84\xe7\240\224\xe5\x8f\x91\343\200\x82\xe6\227\xa0\xe8\xae\272\344\xbd\240\345\206\205\xe5\277\203\345\255\x98\xe5\234\xa8\344\273\200\xe4\xb9\x88\346\xa0\267\347\x9a\204\xe5\x9b\xb0\xe6\203\x91\xef\274\214\xe9\x80\x9a\350\277\207\xe6\xb5\213\xe8\257\x84\xe9\203\275\xe5\217\xaf\xe4\xbb\245\xe6\211\xbe\345\x88\260\xe7\xad\x94\346\241\210\343\x80\x82\x3c\57\160\x3e\15\xa\74\160\x3e\x3c\151\155\147\40\x73\162\x63\75\x22\x53\111\x54\105\137\x55\122\x4c\57\163\x74\x61\x74\x69\x63\57\151\155\x67\57\142\x61\x6e\156\x65\x72\x2e\152\160\x67\42\40\x73\164\171\154\145\x3d\x22\x6d\x61\170\55\x77\x69\144\x74\150\x3a\x31\x30\x30\x25\73\x22\x3e\74\x2f\160\76"; goto sF2eq; bgPwu: $record = Db::table("\x73\x75\142\152\145\143\x74")->where(["\x69\x64" => $id])->field("\151\x64\x2c\15\12\40\x20\40\x20\40\x20\40\40\40\x20\x20\x20\156\141\x6d\x65\x2c\xd\xa\40\x20\x20\40\40\40\40\x20\x20\40\x20\40\163\x75\142\x74\x69\164\x6c\145\x2c\15\xa\x20\40\40\40\x20\40\40\x20\40\x20\x20\x20\143\x75\x72\x72\145\x6e\x74\x5f\x70\162\151\143\x65\x2c\xd\12\40\x20\x20\x20\40\x20\x20\x20\x20\x20\x20\40\x65\x78\160\x65\143\164\x5f\x66\x69\156\151\163\x68\137\x74\x69\x6d\145\x2c\xd\12\40\x20\x20\40\x20\x20\40\x20\40\40\x20\40\x69\x74\145\155\163\x2c\xd\xa\x20\x20\40\x20\40\40\40\x20\40\40\40\40\160\x61\162\164\x69\143\x69\160\141\x6e\x74\x73\x5f\x73\x68\157\x77\40\141\x73\x20\160\x61\x72\x74\151\143\x69\160\141\x6e\x74\x73\54\xd\xa\40\40\40\40\x20\x20\40\x20\40\x20\40\40\x73\x75\142\x6a\145\143\x74\137\x64\x65\x73\143\x2c\15\xa\x20\40\x20\40\x20\40\x20\40\x20\x20\40\x20\163\165\x62\x6a\x65\143\x74\x5f\x74\x69\x70\x2c\15\xa\40\x20\x20\x20\x20\40\40\40\x20\x20\x20\x20\151\155\141\147\x65\137\165\x72\154\54\xd\xa\40\x20\x20\x20\x20\x20\x20\40\x20\40\x20\x20\142\141\x6e\x6e\x65\x72\x5f\x69\155\x67\x2c\xd\12\40\x20\x20\40\40\40\x20\40\x20\40\40\40\164\145\x73\x74\137\x61\x6c\154\157\x77\x5f\142\141\x63\153\x2c\xd\12\40\x20\x20\x20\40\x20\x20\x20\x20\x20\40\40\x74\x65\163\x74\x5f\141\154\x6c\x6f\x77\x5f\x61\156\163\x77\145\162\137\x65\x6d\x70\164\171\x2c\xd\12\x20\x20\40\x20\x20\40\x20\40\x20\x20\40\40\x72\145\160\x6f\x72\164\x5f\x64\145\x6d\x6f\x5f\x69\x6d\x61\147\145\163")->find(); goto Z4aMt; LVErh: $record["\x62\141\x6e\156\145\162\x5f\x69\x6d\x67"] = generateUploadFullUrl(generateThumbnailUrl($imageUrl, 500)); goto oAbud; GcSrW: $record["\157\162\x64\145\162\137\156\157"] = ''; goto mZeNb; TQ6Bc: OfdvV: goto q9Dds; qqXJ8: } protected function getOrderByNo($order_no) { goto PjQ_d; vn3VG: TvC8F: goto gr03r; OVUkA: return $row; goto BXeV9; Zoh5J: $row["\162\x65\x70\x6f\162\164\x5f\154\x69\x73\x74"] = []; goto PAEfY; fbZ0X: $result = json_decode($row["\162\145\x73\x75\154\x74"], true); goto ZZCY0; Pvd63: YN8yj: goto mYUwR; PDS1k: YHByT: goto mh0Zd; nTAJP: return []; goto Pvd63; mh0Zd: DI70h: goto OVUkA; PAEfY: goto YHByT; goto vn3VG; mYUwR: $row = Db::table("\x75\156\x69\x5f\x61\160\x70\x5f\157\x72\144\145\x72\x73")->where(["\x6f\x72\144\145\162\x5f\x6e\157" => $order_no])->field("\52")->find(); goto yQwKI; yQwKI: if (!($row && !empty($row["\x72\145\x73\x75\x6c\164"]))) { goto DI70h; } goto fbZ0X; ZZCY0: if ($result && isset($result["\x72\145\160\x6f\162\x74\x4c\151\x73\164"])) { goto TvC8F; } goto gNs4K; gr03r: $row["\x72\x65\160\157\162\164\137\154\x69\x73\x74"] = $result["\x72\x65\x70\x6f\162\164\x4c\151\163\164"]; goto PDS1k; PjQ_d: if (!empty($order_no)) { goto YN8yj; } goto nTAJP; gNs4K: Log::error("\146\141\x69\154\145\x64\x20\x74\157\x20\144\145\143\x6f\x64\x65\40\x72\x65\x73\x75\x6c\x74\x20\x66\x6f\162\x20\163\165\x62\152\145\x63\164\40\157\x72\x64\x65\x72\72\40{$order_no}"); goto Zoh5J; BXeV9: } public function createOrder($login_user_id, $id, $order_no) { goto UpH1T; vESOJ: wexception("\346\265\x8b\xe8\257\204\351\207\x8f\xe8\xa1\xa8\xe5\214\205\345\x90\xab\xe7\232\x84\351\242\x98\xe7\x9b\256\xe4\xb8\xba\347\xa9\272"); goto NCiAY; O_brS: jtZ_v: goto hAHQ0; UPEum: goto JPWqc; goto O_brS; qeKXu: SWUBd: goto UPEum; w8ubQ: JPWqc: goto TgTHp; zPr7I: pQEla: goto De_iw; kJv1O: if (!empty($res)) { goto SWUBd; } goto RGtWk; UpH1T: $subject = Db::table("\x73\165\x62\x6a\145\143\x74")->where(["\x69\144" => $id])->field("\x2a")->find(); goto HyJIP; hAHQ0: $row = $this->getOrderByNo($order_no); goto EJMaB; vj1m9: K9gRD: goto W7eL0; IRLAh: $order = ["\x6f\x72\x64\145\162\x5f\x6e\x6f" => "\x55\116\x49" . date("\x79\155\144\x48\x69\163") . $login_user_id, "\x75\x73\x65\x72\137\x69\144" => $login_user_id, "\x73\165\142\x6a\145\143\x74\137\151\x64" => $id, "\x6f\x72\x64\x65\162\x5f\141\155\x6f\x75\156\164" => $subject["\x63\165\162\162\x65\x6e\164\x5f\x70\x72\x69\x63\145"], "\157\162\144\145\162\137\164\151\x6d\x65" => date("\x59\x2d\x6d\55\x64\40\110\72\x69\72\x73"), "\164\157\164\x61\x6c\137\151\x74\145\x6d\163" => $subject["\151\x74\x65\x6d\163"], "\x70\x61\171\x5f\x73\164\141\164\x75\163" => $subject["\x63\165\162\162\x65\156\x74\137\x70\162\x69\143\145"] > 0 ? Defs::PAY_WAIT : Defs::PAY_SUCCESS, "\x69\164\x65\x6d\137\166\145\x72\163\151\x6f\x6e" => $subject["\x69\164\x65\x6d\x5f\166\x65\x72\163\x69\157\x6e"]]; goto VTI_X; TgTHp: return $order["\x6f\162\144\x65\162\x5f\x6e\157"]; goto I4pqi; NCiAY: fpFXJ: goto xbhbF; VTI_X: $res = Db::table("\x75\156\151\x5f\141\x70\x70\137\x6f\162\x64\145\162\x73")->insert($order); goto kJv1O; EJMaB: if (!empty($row)) { goto pQEla; } goto IeCFG; HyJIP: if (!empty($subject)) { goto K9gRD; } goto cYGVZ; De_iw: $order = ["\157\162\x64\x65\x72\137\x6e\157" => $row["\157\x72\144\x65\162\137\156\x6f"], "\x75\163\145\162\137\151\x64" => $row["\165\163\x65\162\137\151\x64"], "\x73\165\142\x6a\145\143\164\x5f\151\x64" => $row["\163\x75\x62\152\145\143\x74\x5f\151\144"], "\x6f\162\x64\x65\162\x5f\141\x6d\x6f\x75\156\164" => $row["\157\x72\144\145\162\137\x61\x6d\157\165\156\x74"], "\x6f\162\144\x65\162\x5f\164\x69\x6d\x65" => $row["\157\x72\x64\145\x72\137\x74\x69\155\x65"], "\164\157\164\x61\154\137\x69\164\x65\155\163" => $row["\164\x6f\x74\141\154\x5f\151\164\x65\x6d\x73"], "\160\x61\x79\x5f\x73\x74\x61\164\165\163" => $row["\x70\x61\171\137\x73\164\141\164\x75\x73"]]; goto w8ubQ; xbhbF: if ($order_no) { goto jtZ_v; } goto IRLAh; IeCFG: wexception("\xe6\x97\xa0\346\263\x95\xe6\x89\xbe\xe5\x88\xb0\xe8\xaf\245\xe8\256\242\345\x8d\x95"); goto zPr7I; W7eL0: if (!($subject["\x69\x74\145\155\x73"] == 0)) { goto fpFXJ; } goto vESOJ; RGtWk: wexception("\346\x95\260\346\215\256\345\xba\x93\351\224\231\xe8\257\257"); goto qeKXu; cYGVZ: wexception("\346\227\xa0\xe6\263\225\xe6\211\xbe\345\210\260\xe8\257\245\346\xb5\x8b\xe8\257\x84\xe9\207\217\xe8\241\250"); goto vj1m9; I4pqi: } public function regenOrder($order_no) { goto XRj6I; SuYOn: $order = []; goto kjd91; rCMwM: $order["\x69\164\145\155\163"] = ''; goto nkSPP; bMibs: $order["\151\164\x65\x6d\x5f\x76\x65\162\163\x69\157\156"] = $subject["\151\x74\145\155\x5f\x76\x65\162\x73\x69\x6f\x6e"]; goto mYjCu; j1NMX: SxQLJ: goto EUc9e; XRj6I: $order = $this->getOrderByNo($order_no); goto Pg6Yj; EUc9e: $subject = Db::table("\x73\x75\x62\152\145\143\164")->where(["\151\144" => $order["\x73\x75\x62\152\145\143\x74\x5f\151\x64"]])->field("\x2a")->find(); goto o4TbS; HsjoV: $order["\164\x65\x73\164\137\151\x74\x65\155\163"] = 0; goto u2gpr; u2gpr: $order["\143\x75\x72\x72\137\x69\164\x65\155"] = 0; goto rCMwM; kjd91: $order["\x74\157\x74\141\x6c\137\151\164\145\x6d\x73"] = $subject["\151\x74\145\x6d\163"]; goto HsjoV; nkSPP: $order["\162\x65\163\165\154\x74"] = null; goto RdL_x; Pg6Yj: if (!empty($order)) { goto SxQLJ; } goto QNRgP; RdL_x: $order["\x66\x69\156\x69\x73\150\x65\x64"] = 0; goto bMibs; nAyCl: WmYWS: goto SuYOn; QNRgP: wexception("\346\xb5\x8b\xe8\257\204\xe8\xae\xa2\xe5\215\225\344\xb8\215\xe5\255\x98\345\234\250\357\xbc\x9a" . $order_no); goto j1NMX; r7RVb: wexception("\346\xb5\213\350\xaf\x84\344\xb8\x8d\xe5\xad\230\345\234\xa8"); goto nAyCl; mYjCu: Db::table("\165\156\x69\137\x61\x70\160\x5f\x6f\162\144\145\x72\163")->where("\x6f\x72\144\x65\162\x5f\156\x6f", $order_no)->update($order); goto hj0cl; o4TbS: if (!empty($subject)) { goto WmYWS; } goto r7RVb; hj0cl: } public function makeTestSubjectItems($items, $subjectItems) { goto QptqK; hZoTK: NKY3P: goto cFM1Q; pNaHh: $subjectItemsClone = []; goto sY1zp; vcTcK: iIGs4: goto pNaHh; rRkue: AN42n: goto rnvoQ; NwWWT: $itemExists = explode("\x2c", $items); goto MzzUl; z39qw: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto FhM14; QosFU: yoWh1: goto XeFvJ; JrUgO: $subjectItem["\x76\141\154\165\145"] = $subjectItemsExist[$subjectItemId]["\166\x61\154\165\x65"]; goto QosFU; FhM14: if (!(isset($subjectItemsExist[$subjectItemId]) && $subjectItem["\164\x79\160\x65"] == $subjectItemsExist[$subjectItemId]["\164\x79\x70\145"])) { goto yoWh1; } goto JrUgO; XeFvJ: fCCmL: goto c7WQ6; c7WQ6: } goto BNi0f; cFM1Q: return $subjectItemsClone; goto jOscb; sY1zp: $index = 0; goto JIk59; MzzUl: foreach ($itemExists as $itemExist) { goto Ra0XT; Mn47F: goto V8eId; goto WW48j; V_HNi: $subjectItemsExist[$itemIdExist] = ["\x74\x79\160\145" => $itemTypeExist, "\x76\141\154\x75\x65" => $itemTypeExist == Defs::QUESTION_CHECKBOX ? explode("\55", $itemValueExist) : $itemValueExist]; goto rqNyl; ORr25: $itemIdExist = $itemSections[0]; goto tDTL9; rqNyl: V8eId: goto OFU1B; Ra0XT: $itemSections = explode("\x26", $itemExist); goto hrDJ4; tDTL9: $itemTypeExist = $itemSections[1]; goto kBnOu; WW48j: vDXTc: goto ORr25; kBnOu: $itemValueExist = $itemSections[2]; goto V_HNi; hrDJ4: if (!(count($itemSections) != 3)) { goto vDXTc; } goto Mn47F; OFU1B: } goto b21Aq; iX1ZU: $subjectItemsExist = []; goto NwWWT; BNi0f: T22eK: goto rRkue; JIk59: foreach ($subjectItems as $key => $item) { goto VHFl1; VAJ4Q: js2_S: goto n7L1h; B25r6: $item["\x6e\145\170\164\137\151\x64"] = "\151\x64\x5f" . $item["\156\x65\170\164\137\151\x64"]; goto QJ3YW; ZX8Ty: $item["\160\x72\145\x76\137\x69\144"] = "\151\x64\x5f" . $item["\x70\x72\x65\166\137\x69\144"]; goto nvLDx; QJ3YW: fkdnN: goto wksEq; VHFl1: if (!($index > 0)) { goto l1Ep_; } goto ZX8Ty; nvLDx: l1Ep_: goto C_6KA; C_6KA: if (!($index < count($subjectItems) - 1)) { goto fkdnN; } goto B25r6; dheGa: $index++; goto VAJ4Q; wksEq: $subjectItemsClone["\x69\144\x5f" . $key] = $item; goto dheGa; n7L1h: } goto hZoTK; b21Aq: km0Pe: goto z39qw; rnvoQ: foreach ($subjectItems as $subjectItemId => &$subjectItem) { goto ta1SL; YcllN: H991f: goto nANre; vy7t6: $imageField = "\x69\155\x61\147\145\137" . $optionIndex; goto u6AX3; eCE9N: AbvnB: goto MXh1t; kvTub: $optionIndex++; goto D1NJl; u7oA0: $subjectItem["\151\155\x61\x67\x65"] = generateUploadFullUrl(generateThumbnailUrl($subjectItem["\x69\x6d\x61\147\145"], 200)); goto eCE9N; nANre: if (!($optionIndex <= 12)) { goto PoAXN; } goto vy7t6; gJQ17: K3las: goto kvTub; MXh1t: $optionIndex = 1; goto YcllN; D1NJl: goto H991f; goto jSFfT; IkLsb: $subjectItem[$imageField] = generateUploadFullUrl(generateThumbnailUrl($subjectItem[$imageField], 100)); goto gJQ17; ta1SL: if (!$subjectItem["\151\x6d\x61\x67\145"]) { goto AbvnB; } goto u7oA0; jSFfT: PoAXN: goto lzRqU; u6AX3: if (!$subjectItem[$imageField]) { goto K3las; } goto IkLsb; lzRqU: J7_9M: goto mkyKY; mkyKY: } goto vcTcK; QptqK: if (!$items) { goto AN42n; } goto iX1ZU; jOscb: } public function answer($order_no, $item_id, $item_type, $item_option) { try { goto K8u3b; IR8VG: nWJkM: goto IkSkv; rVY8w: exception("\351\207\x8f\xe8\241\250\351\xa2\x98\xe7\233\xae\xe4\270\x8d\345\xad\x98\xe5\x9c\250"); goto q3sje; aNk4G: $order = array_merge($order, $update); goto aEp95; a140w: $update["\162\145\163\x75\x6c\x74"] = json_encode(["\x72\145\160\x6f\162\164\114\x69\x73\x74" => $result], JSON_UNESCAPED_UNICODE); goto f8Par; imPma: nMtK_: goto uDLle; pO6_T: $answer = []; goto UHiYo; F7MqB: $item_option = htmlspecialchars($item_option); goto dEu5x; FTuXI: exception("\xe6\265\x8b\350\257\204\xe5\xb7\262\xe5\256\x8c\xe6\x88\220"); goto Z2V72; Zo0_E: iCVb3: goto hxUKw; RHjUZ: $update["\x77\x61\162\156\x69\x6e\147\137\x6c\x65\x76\x65\154"] = Defs::MEASURE_WARNING_UNKOWN_LEVEL; goto WVlQZ; SzqCs: foreach ($itemExists as $itemExist) { goto dfaJb; bg675: $answer[$itemIdExist] = $itemExist; goto rSEDP; rSEDP: FPFHa: goto qwr0r; dfaJb: $itemIdExist = explode("\46", $itemExist)[0]; goto RLK5E; Praag: goto U_3Io; goto yFuwB; RLK5E: if (!($itemIdExist == $item_id)) { goto PImvO; } goto Praag; yFuwB: PImvO: goto bg675; qwr0r: } goto DV1PC; jNai9: eZJDi: goto ggNvn; wd2hW: if (!empty($item_option)) { goto nWJkM; } goto K366l; DV1PC: U_3Io: goto WCa6x; K366l: $item_option = []; goto IR8VG; MTLYd: $update["\x74\x65\163\164\x5f\x69\164\x65\155\163"] = 1; goto Zo0_E; apCwV: exception("\346\xb5\213\350\257\x84\351\241\xb9\xe7\233\256\xe7\211\210\xe6\x9c\xac\xe5\x8f\221\347\224\237\xe4\xba\206\345\x8f\x98\xe6\x9b\264\357\274\214\xe9\234\200\xe8\246\x81\351\x87\215\xe6\x96\xb0\346\265\213\350\xaf\204", -1); goto AMsFs; EcZ57: $update["\x69\164\145\155\163"] = join("\x2c", $answer); goto gj81d; wDB8k: QczWV: goto UYktg; mEOzs: if (!empty($order)) { goto nMtK_; } goto iigq_; Z2V72: StwLP: goto khHDU; sWqKA: goto OQLpW; goto nGW2S; VzQk2: $itemExists = explode("\x2c", $order["\x69\x74\145\x6d\163"]); goto SzqCs; mfy3b: if (!empty($item)) { goto c9HoY; } goto FdhrQ; VCGMQ: $item_option = str_replace("\x26", "\40", $item_option); goto F7MqB; IkSkv: if (!is_string($item_option)) { goto REzfw; } goto tCeB5; CkAkX: goto iCVb3; goto K77I0; wXXLb: $result = SubjectLogic::I()->generateTestResult($order["\163\165\x62\x6a\145\x63\x74\137\151\144"], Subjects::I()->parseOrderItems($update["\x69\164\x65\x6d\163"])); goto RHjUZ; AMsFs: VOpwy: goto OZ1jC; ggNvn: if (!($order["\x69\x74\x65\x6d\137\x76\145\162\163\x69\157\156"] != $subject["\151\x74\145\x6d\137\166\145\162\x73\x69\x6f\x6e"])) { goto VOpwy; } goto apCwV; VTaEW: $item_option = join("\x2d", $item_option); goto kRTxp; AZ3e3: $item_option = htmlspecialchars_decode($item_option); goto KR7ay; hxUKw: if ($item_type == Defs::QUESTION_TEXT) { goto zEr84; } goto CLejp; ztSpT: exception("\350\xaf\xa5\346\xb5\x8b\350\xaf\204\350\256\xa2\345\215\x95\xe5\x85\xb3\xe8\x81\224\351\207\x8f\350\xa1\xa8\344\270\xa2\345\xa4\xb1\xef\xbc\x9a" . $order_no); goto jNai9; Qwdkw: if (!empty($subjectItems)) { goto QczWV; } goto BajrY; UHiYo: if ($order["\x74\145\163\x74\x5f\151\164\145\x6d\163"] == "\60") { goto vuvl6; } goto VzQk2; FdhrQ: exception("\350\xaf\204\346\xb5\213\xe9\xa2\x98\xe7\x9b\256\xe4\xb8\x8d\xe5\xad\230\345\234\250\357\274\x9a" . $item_id); goto V_Sjm; BajrY: exception("\xe9\x87\x8f\xe8\xa1\250\xe9\xa1\xb9\347\233\xae\xe4\xb8\x8d\345\xad\230\xe5\x9c\xa8"); goto wDB8k; VD6gA: $update["\x63\165\162\x72\x5f\x69\x74\x65\x6d"] = $item_id; goto pO6_T; K8u3b: $order = $this->getOrderByNo($order_no); goto mEOzs; nGW2S: zEr84: goto AZ3e3; UYktg: if (isset($subjectItems[$item_id])) { goto l0j9d; } goto rVY8w; mflbJ: $answer[$item_id] = $item_id . "\x26" . $item_type . "\x26" . $item_option; goto EcZ57; V_Sjm: c9HoY: goto wkgtW; khHDU: $subject = Subjects::I()->getSubjectById($order["\x73\x75\142\152\x65\143\164\137\151\x64"]); goto wz9kz; gj81d: if (!empty($item["\x6e\x65\170\x74\137\151\x64"])) { goto SxB62; } goto aT2Z7; tCeB5: $item_option = htmlspecialchars_decode($item_option); goto XRxeu; YZK7m: Db::table("\x75\156\x69\137\x61\160\160\137\x6f\162\x64\x65\162\163")->where(["\x6f\x72\144\145\x72\x5f\x6e\x6f" => $order_no])->update($update); goto aNk4G; WVlQZ: array_walk($result, function ($item) use(&$update) { goto X_VTF; JVhaQ: yH7zK: goto mMpY3; mMpY3: if (!($item["\167\141\162\x6e\151\x6e\x67\x5f\x6c\145\x76\145\x6c"] > $update["\167\x61\162\156\x69\x6e\x67\x5f\x6c\145\166\x65\x6c"])) { goto zLHBQ; } goto kRP2m; X_VTF: if (isset($item["\x77\141\x72\x6e\151\x6e\147\137\x6c\x65\x76\145\154"])) { goto yH7zK; } goto WKo6Z; WKo6Z: return; goto JVhaQ; kRP2m: $update["\x77\141\162\156\151\156\x67\137\154\x65\x76\145\x6c"] = $item["\x77\x61\x72\156\151\x6e\x67\137\154\x65\166\x65\x6c"]; goto RsE4_; RsE4_: zLHBQ: goto niLD4; niLD4: }); goto a140w; WCa6x: $update["\x74\x65\163\x74\x5f\x69\x74\x65\155\x73"] = count($answer) + 1; goto CkAkX; XRxeu: $item_option = json_decode($item_option, true); goto EoVDv; KR7ay: $item_option = str_replace("\54", "\73", $item_option); goto VCGMQ; wkgtW: $update = []; goto VD6gA; K77I0: vuvl6: goto MTLYd; wz9kz: if (!empty($subject)) { goto eZJDi; } goto ztSpT; dEu5x: OQLpW: goto mflbJ; EoVDv: REzfw: goto VTaEW; kRTxp: dkdnm: goto sWqKA; OZ1jC: $subjectItems = Subjects::I()->getSubjectItems($order["\x73\x75\x62\152\145\143\x74\x5f\x69\144"]); goto Qwdkw; f8Par: SxB62: goto YZK7m; q3sje: l0j9d: goto uBzpA; aT2Z7: $update["\146\x69\x6e\151\x73\150\145\144"] = 1; goto Ni6NQ; uDLle: if (!$order["\x66\151\156\151\163\150\145\x64"]) { goto StwLP; } goto FTuXI; iigq_: exception("\346\x97\xa0\346\xb3\225\xe6\211\xbe\345\210\xb0\xe8\257\xa5\346\265\x8b\350\xaf\204\xe8\xae\xa2\345\215\225"); goto imPma; Ni6NQ: $update["\x66\151\156\151\x73\150\137\x74\151\155\145"] = date("\131\x2d\155\x2d\144\x20\x48\x3a\x69\72\163"); goto wXXLb; uBzpA: $item = $subjectItems[$item_id]; goto mfy3b; CLejp: if (!($item_type == Defs::QUESTION_CHECKBOX)) { goto dkdnm; } goto wd2hW; aEp95: } catch (\Exception $e) { goto V6mDX; UIQP1: if (!($exceptionCode == -1)) { goto W9TqE; } goto ZZA9E; Spg52: W9TqE: goto PcYUp; PcYUp: wexception($e->getMessage()); goto K33X1; ZZA9E: wexception("\xe6\xb5\x8b\xe8\257\x84\351\241\271\xe7\233\256\347\211\210\346\234\254\345\x8f\x98\346\233\264", -1); goto Spg52; V6mDX: $exceptionCode = $e->getCode(); goto UIQP1; K33X1: } return ["\146\151\156\x69\x73\150\145\144" => $order["\x66\x69\x6e\151\163\150\x65\144"]]; } }
