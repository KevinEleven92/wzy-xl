<?php
 namespace app\index\model; use think\Model; use think\Cache; use think\Log; class Setting extends Model { protected $tableName = "\x73\x65\x74\164\x69\x6e\x67"; protected $pk = "\153\x65\171"; protected static $_settingMemoryCache = array(); public function setMemorySetting($field, $value) { goto UZYaG; bKhcR: $this->getSetting(); goto xEj_t; UZYaG: if (!empty(self::$_settingMemoryCache)) { goto PLhnf; } goto bKhcR; xEj_t: PLhnf: goto T2NHx; T2NHx: self::$_settingMemoryCache[$field]["\x76\x61\x6c\165\x65"] = $value; goto Mxisb; Mxisb: } public function getSetting($field = null) { goto rdD2m; EYZbs: return self::$_settingMemoryCache[$field]["\166\x61\154\165\145"]; goto iuhj1; p5YyF: goto K1tQr; goto m1djn; rEIgD: FVBkc: goto dUnxL; iuhj1: Db9nf: goto BgScs; dUnxL: PMf6j: goto w68i5; UvLug: return $items; goto cdWro; idLio: if (isset($items[$field])) { goto pp2C_; } goto N7_bm; V11cE: if (!empty($items)) { goto Yluci; } goto uo0VC; zhG8V: K1tQr: goto va3RV; Kkmu3: $where = "\x60\153\x65\171\140\x20\x69\156\x28\x27" . implode("\x27\x2c\47", $fields) . "\47\51"; goto SfKD6; GqmSX: $items = dict('', "\x73\x65\x74\164\151\156\x67"); goto V11cE; b8XhE: $fields = array_keys($items); goto Kkmu3; FwHPT: C3vHO: goto PASbH; Q1XyI: Yluci: goto b8XhE; UI9we: if ($field) { goto bvA6U; } goto PfIzq; rdD2m: if (!($field && isset(self::$_settingMemoryCache[$field]))) { goto Db9nf; } goto EYZbs; fXro7: if (array_key_exists($field, $items)) { goto hxcFW; } goto jNRqM; m1djn: bvA6U: goto idLio; uo0VC: return null; goto Q1XyI; SfKD6: $data = $this->where($where)->column("\153\145\x79\54\166\141\x6c\165\x65"); goto NFfy_; N7_bm: return null; goto PT107; PASbH: Cache::set("\x73\171\x73\164\x65\155\x5f\x73\145\x74\x74\151\x6e\x67", $items); goto SKhVY; PT107: pp2C_: goto aawyh; NFfy_: foreach ($items as $key => &$arr) { goto o6hVv; LTx27: hzBfd: goto J_Gno; uCb8P: $arr["\x6b\145\171"] = $key; goto LTx27; D432v: h0e84: goto dfR_r; o6hVv: switch ($key) { case "\x4c\x4f\x47\x49\x4e\x5f\x4f\x4e\114\x59\x5f\117\116\105": case "\163\x75\x62\x6a\x65\143\x74\x5f\x73\x68\x6f\x77\137\x70\x72\151\143\x65": case "\163\145\156\144\x5f\141\x70\160\157\151\156\164\137\x6f\162\x64\x65\x72\x5f\164\157\x5f\145\x78\160\145\162\164": case "\163\x65\x6e\144\x5f\141\160\160\157\151\x6e\164\137\x6f\162\144\x65\x72\137\x74\x6f\x5f\x63\165\163\164\x6f\155\x65\162": goto v5hO1; Hxeee: bnFea: goto v05vR; v05vR: goto E3vCD; goto fVihp; v5hO1: if (!isset($data[$key])) { goto bnFea; } goto ADHl1; ADHl1: $data[$key] = $data[$key] ? "\x79\145\163" : "\x6e\157"; goto Hxeee; fVihp: case "\141\160\x70\157\151\156\x74\137\x74\x69\160": goto H0jS0; dfjMA: goto E3vCD; goto fuJI_; UxrdN: $data[$key] = htmlspecialchars_decode($data[$key]); goto fqHok; fqHok: vnAyy: goto dfjMA; H0jS0: if (!isset($data[$key])) { goto vnAyy; } goto UxrdN; fuJI_: } goto D432v; bYJ8z: $arr["\x76\141\154\165\x65"] = array_key_exists($key, $data) ? $data[$key] : $arr["\144\x65\x66\141\x75\154\x74"]; goto uCb8P; dfR_r: E3vCD: goto bYJ8z; J_Gno: } goto FwHPT; BgScs: $items = Cache::get("\x73\x79\x73\x74\x65\x6d\x5f\x73\x65\x74\x74\x69\x6e\x67"); goto Qlak6; aawyh: return $items[$field]["\166\x61\x6c\x75\145"]; goto zhG8V; HPIbq: return $items[$field]["\166\141\x6c\x75\x65"]; goto rEIgD; Mhc1u: self::$_settingMemoryCache = $items; goto UI9we; SKhVY: self::$_settingMemoryCache = $items; goto tPqGJ; wJ7lc: hxcFW: goto HPIbq; cdWro: goto PMf6j; goto vrsKJ; jNRqM: return null; goto DwElj; DwElj: goto FVBkc; goto wJ7lc; va3RV: Yu9cq: goto GqmSX; PfIzq: return $items; goto p5YyF; Qlak6: if (!$items) { goto Yu9cq; } goto Mhc1u; vrsKJ: nVUCL: goto fXro7; tPqGJ: if ($field) { goto nVUCL; } goto UvLug; w68i5: } public function saveSetting($datas = array()) { goto Ggwco; LvImR: XacYm: goto gKVLB; jRCYD: foreach ($datas as $data) { goto I2AVi; b2t3h: if (in_array($data["\153\145\x79"], $allowedKeys)) { goto YHhCC; } goto fSukq; aq_AS: goto Nhbc0; goto XnHHg; XnHHg: YHhCC: goto yMIpG; Pfz37: pu1PM: goto G_irI; I2AVi: switch ($data["\x6b\145\x79"]) { case "\x4c\x4f\107\x49\116\x5f\117\116\114\x59\137\x4f\116\105": case "\x73\165\142\152\x65\143\164\137\163\150\x6f\167\x5f\160\x72\151\x63\145": case "\x73\x65\x6e\144\137\141\160\160\157\x69\156\164\137\x6f\x72\144\145\162\x5f\x74\x6f\x5f\x65\170\160\x65\162\164": case "\x73\x65\156\144\137\141\x70\160\157\151\156\164\x5f\157\x72\144\145\162\x5f\164\157\137\x63\165\163\164\x6f\x6d\x65\x72": $data["\166\x61\154\x75\x65"] = $data["\166\141\x6c\x75\145"] == "\x79\x65\163" ? 1 : 0; } goto Pfz37; RWlhQ: $result = true; goto gPSFd; Y_iRO: MYgW3: goto PSm3z; V9pPt: if (!$state) { goto ODK4V; } goto RWlhQ; fSukq: $state = $this->isUpdate(false)->data($data)->save(); goto aq_AS; yMIpG: $state = $this->where(array("\153\x65\171" => $data["\153\145\x79"]))->update($data); goto RRPRM; RRPRM: Nhbc0: goto V9pPt; gPSFd: ODK4V: goto Y_iRO; G_irI: le7Jz: goto b2t3h; PSm3z: } goto LvImR; Htblt: $result = false; goto jRCYD; XF60M: $this->where("\140\x6b\x65\x79\140\40\x6e\x6f\x74\40\151\156\50\x27" . implode("\x27\54\47", $settingField) . "\x27\51")->delete(); goto yU_Oj; yU_Oj: $where = "\140\153\x65\x79\x60\40\x69\156\x28\47" . implode("\x27\54\x27", $settingField) . "\47\x29"; goto ZPXGX; ZPXGX: $allowedKeys = $this->where($where)->column("\153\145\171"); goto Htblt; hFXK3: YwTr2: goto aP6RY; Y7gcO: return true; goto hFXK3; gKVLB: $this->clearCache(); goto B0C6k; lXEs_: return false; goto ajZFP; iOB7p: $settingField = array_keys($fields); goto XF60M; ajZFP: xoQxl: goto iOB7p; B0C6k: return $result; goto CA54u; aP6RY: $fields = dict('', "\163\x65\164\x74\151\x6e\x67"); goto n0aZD; n0aZD: if (!empty($fields)) { goto xoQxl; } goto lXEs_; Ggwco: if ($datas) { goto YwTr2; } goto Y7gcO; CA54u: } public function clearCache() { Cache::rm("\163\171\x73\164\145\x6d\137\163\x65\164\164\x69\x6e\147"); } }
