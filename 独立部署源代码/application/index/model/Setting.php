<?php
 namespace app\index\model; use think\Model; use think\Cache; use think\Log; class Setting extends Model { protected $tableName = "\x73\x65\164\x74\151\156\x67"; protected $pk = "\x6b\x65\171"; protected static $_settingMemoryCache = array(); public function setMemorySetting($field, $value) { goto obyaT; UH_W2: $this->getSetting(); goto dBoiQ; obyaT: if (!empty(self::$_settingMemoryCache)) { goto PG4Sh; } goto UH_W2; dBoiQ: PG4Sh: goto sGD2L; sGD2L: self::$_settingMemoryCache[$field]["\x76\x61\154\x75\145"] = $value; goto hdi80; hdi80: } public function getSetting($field = null) { goto DIL4p; ioa2c: if (array_key_exists($field, $items)) { goto cUUch; } goto JF2g1; EbY8V: d50sm: goto LonNJ; byzON: t7LL2: goto e3G2k; eu2IW: if (!empty($items)) { goto t7LL2; } goto zvMCs; n2R5W: goto ikAca; goto XZd_D; b29xT: self::$_settingMemoryCache = $items; goto IVvyg; zvMCs: return null; goto byzON; nmyDt: return $items[$field]["\x76\141\x6c\x75\x65"]; goto R54Qs; nn_L0: FWkBu: goto WQjwP; nbN09: jgrjs: goto eUASv; Vm0df: if (!$items) { goto ygbgl; } goto b29xT; R54Qs: ikAca: goto m5UWc; E8eFt: return $items; goto XGYsj; eUASv: $items = Cache::get("\x73\171\163\x74\x65\155\x5f\163\145\164\x74\x69\x6e\x67"); goto Vm0df; e3G2k: $fields = array_keys($items); goto SAmBk; X4nPu: if ($field) { goto b8Y8V; } goto E8eFt; uPTJw: p2k6w: goto qomMc; DBfiv: return self::$_settingMemoryCache[$field]["\x76\141\x6c\165\x65"]; goto nbN09; IVvyg: if ($field) { goto d50sm; } goto Milk3; QUXJ8: $items = dict('', "\x73\x65\x74\x74\151\156\x67"); goto eu2IW; SAmBk: $where = "\140\153\x65\171\140\x20\151\x6e\x28\x27" . implode("\47\54\47", $fields) . "\47\x29"; goto rsDjv; SpDyl: b8Y8V: goto ioa2c; Milk3: return $items; goto Z4hPB; qomMc: ygbgl: goto QUXJ8; rsDjv: $data = $this->where($where)->column("\x6b\145\171\x2c\166\x61\x6c\165\145"); goto XhXrK; JF2g1: return null; goto n2R5W; DIL4p: if (!($field && isset(self::$_settingMemoryCache[$field]))) { goto jgrjs; } goto DBfiv; Z4hPB: goto p2k6w; goto EbY8V; XZd_D: cUUch: goto nmyDt; XhXrK: foreach ($items as $key => &$arr) { goto ngK6x; dqbYe: heGi8: goto kcYMg; kcYMg: $arr["\166\141\154\165\x65"] = array_key_exists($key, $data) ? $data[$key] : $arr["\x64\145\146\141\x75\x6c\x74"]; goto PYVxv; PYVxv: $arr["\153\x65\171"] = $key; goto pxGPv; LliVv: f0ARv: goto dqbYe; ngK6x: switch ($key) { case "\114\x4f\107\111\x4e\x5f\117\x4e\x4c\131\137\117\116\x45": case "\x73\165\x62\152\x65\x63\x74\x5f\x73\x68\x6f\167\x5f\x70\x72\x69\143\x65": case "\x73\145\156\144\137\x61\160\160\157\151\x6e\x74\137\x6f\x72\x64\x65\162\137\x74\x6f\x5f\145\170\160\x65\x72\164": case "\x73\145\x6e\144\137\x61\160\x70\157\x69\x6e\x74\137\157\162\144\x65\x72\137\x74\x6f\x5f\143\165\163\x74\x6f\x6d\145\x72": goto bgUPy; bgUPy: if (!isset($data[$key])) { goto PxdGp; } goto Nnv3p; C0nUw: PxdGp: goto z4k1n; Nnv3p: $data[$key] = $data[$key] ? "\171\145\163" : "\156\157"; goto C0nUw; z4k1n: goto heGi8; goto SIvl1; SIvl1: case "\x61\x70\160\x6f\151\156\164\x5f\x74\151\160": goto pG8rY; pG8rY: if (!isset($data[$key])) { goto kzjd3; } goto MnV2m; CcbOX: goto heGi8; goto p0Shg; MnV2m: $data[$key] = htmlspecialchars_decode($data[$key]); goto raSm7; raSm7: kzjd3: goto CcbOX; p0Shg: } goto LliVv; pxGPv: Css92: goto qstit; qstit: } goto VrCPh; XGYsj: goto pU3gW; goto SpDyl; hI6Wi: return null; goto nn_L0; WQjwP: return $items[$field]["\166\x61\x6c\x75\145"]; goto uPTJw; DPVNo: Cache::set("\163\x79\x73\x74\x65\155\x5f\x73\x65\164\164\x69\156\147", $items); goto oxodh; m5UWc: pU3gW: goto cHbJO; oxodh: self::$_settingMemoryCache = $items; goto X4nPu; VrCPh: HbM0e: goto DPVNo; LonNJ: if (isset($items[$field])) { goto FWkBu; } goto hI6Wi; cHbJO: } public function saveSetting($datas = array()) { goto Y7Pty; Y7Pty: if ($datas) { goto Z0NgK; } goto BmeJA; R3k_F: Z0NgK: goto akRo1; XxZ4W: if (!empty($fields)) { goto DWLn_; } goto UdIUA; EhBgN: $where = "\140\x6b\145\171\x60\40\151\156\x28\47" . implode("\47\x2c\x27", $settingField) . "\x27\x29"; goto NgUyS; gJk1Y: $settingField = array_keys($fields); goto jM_ga; LmDT9: $this->clearCache(); goto pxnps; pxnps: return $result; goto PEzY1; MRAD7: foreach ($datas as $data) { goto w8l2y; z9jvt: mnmPm: goto wt_tz; wt_tz: ehXcG: goto X3swB; brplp: if (!$state) { goto y9rIK; } goto b8MmB; b8MmB: $result = true; goto RxrP3; ZQl6v: zBbOO: goto brplp; YXBeI: $state = $this->where(array("\153\x65\x79" => $data["\x6b\145\171"]))->update($data); goto ZQl6v; fkzVP: goto zBbOO; goto Ghfv0; X3swB: if (in_array($data["\153\145\x79"], $allowedKeys)) { goto oZb2s; } goto GQuwI; RxrP3: y9rIK: goto ZdEMl; ZdEMl: CqDNF: goto Gq8ER; GQuwI: $state = $this->isUpdate(false)->data($data)->save(); goto fkzVP; Ghfv0: oZb2s: goto YXBeI; w8l2y: switch ($data["\x6b\x65\x79"]) { case "\114\117\x47\111\116\x5f\x4f\116\x4c\x59\x5f\x4f\116\105": case "\163\165\142\152\x65\x63\164\x5f\x73\x68\x6f\167\137\160\x72\x69\143\145": case "\x73\x65\156\x64\x5f\x61\x70\x70\x6f\151\x6e\x74\x5f\x6f\162\144\145\162\137\x74\x6f\137\145\x78\160\x65\x72\164": case "\x73\x65\x6e\x64\137\141\160\160\x6f\x69\x6e\x74\x5f\x6f\x72\x64\145\162\x5f\x74\x6f\x5f\x63\x75\163\x74\157\x6d\x65\x72": $data["\x76\x61\x6c\165\145"] = $data["\166\x61\x6c\x75\145"] == "\x79\145\x73" ? 1 : 0; } goto z9jvt; Gq8ER: } goto Cw_Sd; jM_ga: $this->where("\x60\x6b\145\x79\140\40\156\157\x74\x20\151\156\50\47" . implode("\47\54\47", $settingField) . "\47\51")->delete(); goto EhBgN; jlgic: DWLn_: goto gJk1Y; NgUyS: $allowedKeys = $this->where($where)->column("\x6b\145\x79"); goto hs2y8; hs2y8: $result = false; goto MRAD7; BmeJA: return true; goto R3k_F; akRo1: $fields = dict('', "\163\145\x74\x74\151\x6e\x67"); goto XxZ4W; UdIUA: return false; goto jlgic; Cw_Sd: vUS6T: goto LmDT9; PEzY1: } public function clearCache() { Cache::rm("\163\171\x73\x74\x65\155\x5f\163\145\164\x74\151\x6e\x67"); } }
