<?php
 namespace app\index\logic; use app\index\logic\Defs as IndexDefs; use app\index\model\Setting; use think\Cache; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs; use app\index\service\EventLogs; use app\index\model\Expert as ExpertModel; use app\index\service\RequestContext; use app\index\service\OperationLogs; class Expert extends Base { const AVATAR_DEFAULT_IMAGE = "\x2f\163\164\141\164\151\143\x2f\x69\155\x67\x2f\x69\155\x61\x67\145\x5f\165\x70\154\157\141\x64\56\160\x6e\x67"; protected function __construct() { parent::__construct(); } public function load($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = '', $order = '') { goto YbTaP; X3nFz: oCRhM: goto l4JqL; TkJxX: aTWZ1: goto GIKPs; pJFDZ: mFfzj: goto SubgT; dExgo: goto VT0Jj; goto TlsxG; FIzNI: if (emptyInArray($search, "\145\x78\160\x65\x72\x74\137\151\x64")) { goto k788L; } goto FiZqR; YbTaP: if ($sort == "\x74\157\164\x61\154\137\x61\160\160\157\151\156\x74\137\161\165\141\x6e\x74\x69\164\x79") { goto nYV4N; } goto VZcy7; OIbXW: if (emptyInArray($search, "\162\x65\141\x6c\137\x6e\141\155\x65")) { goto IpsfM; } goto SXLVA; JAPEX: $order = "\x74\x6f\164\x61\154\137\x61\160\160\x6f\151\156\x74\137\161\x75\x61\x6e\x74\x69\164\x79\40" . $order; goto TkJxX; GIKPs: $conditions = ["\144\145\154\145\164\x65\x5f\146\x6c\x61\147" => 0]; goto OIbXW; g1bC2: $conditions["\x64\x65\154\145\x74\145\137\146\x6c\141\x67"] = $search["\144\x65\x6c\x65\x74\145\137\x66\154\x61\x67"]; goto X3nFz; znrm9: $conditions["\x63\145\154\x6c\160\150\157\156\145"] = ["\x6c\151\x6b\145", "\45" . $search["\x63\145\x6c\154\x70\150\x6f\x6e\145"] . "\x25"]; goto pJFDZ; GXQ5C: if (emptyInArray($search, "\143\x65\154\154\x70\150\157\x6e\145")) { goto mFfzj; } goto znrm9; DYTxM: goto aTWZ1; goto KAocA; SXLVA: $conditions["\162\x65\x61\154\137\156\x61\155\145"] = ["\x6c\x69\153\145", "\x25" . $search["\162\x65\141\154\x5f\x6e\x61\155\x65"] . "\x25"]; goto lV3R1; G5yc2: BmOYc: goto FIzNI; TlsxG: zp55x: goto XlIwU; r8LAJ: $records = Db::table("\145\170\x70\x65\162\x74")->where($conditions)->page($page, $rows)->order($order)->field(true)->select(); goto Wcw18; ZSwgl: VT0Jj: goto DYTxM; VZcy7: if ($sort == "\x73\164\141\x74\165\163") { goto zp55x; } goto gRdhW; m8Hhr: k788L: goto wPceO; SubgT: if (emptyInArray($search, "\x73\164\141\x74\165\163")) { goto BmOYc; } goto sMP60; KAocA: nYV4N: goto JAPEX; XlIwU: $order = "\x73\x74\141\x74\165\x73\40" . $order; goto ZSwgl; jQSAo: sQOgF: goto E6WYf; FiZqR: $conditions["\x69\x64"] = $search["\145\170\x70\x65\162\164\137\151\144"]; goto m8Hhr; l4JqL: $totalCount = Db::table("\145\x78\x70\145\162\164")->where($conditions)->count(); goto r8LAJ; E6WYf: return ["\x74\157\x74\x61\x6c" => $totalCount, "\162\157\x77\x73" => $records]; goto e4f5D; lV3R1: IpsfM: goto GXQ5C; Wcw18: foreach ($records as &$record) { goto dvoQO; dvoQO: $record["\x77\157\x72\x6b\x69\155\147\137\165\162\x6c"] = generateThumbnailUrl($record["\167\x6f\x72\x6b\151\x6d\147\137\165\162\154"], 100); goto EZx3N; EZx3N: $record["\x66\151\145\154\144\x5f\x69\164\x65\155\163"] = implode("\x2c", Db::table("\145\x78\x70\145\x72\x74\137\x66\151\x65\154\x64\137\162\x65\154\141\x74\x65")->alias("\x45\x46\x52")->join("\145\x78\160\x65\162\164\137\x66\x69\x65\154\144\x5f\x69\x74\x65\155\x20\x45\106\111", "\105\106\122\x2e\146\151\x65\154\x64\x5f\x69\x74\145\x6d\137\151\x64\x3d\x45\106\x49\56\x69\x64")->where("\105\x46\x52\56\x65\x78\160\x65\x72\164\137\x69\144", $record["\x69\x64"])->column("\105\x46\111\56\146\x69\x65\154\144\x5f\151\x74\145\155")); goto kEvvC; kEvvC: Wejt_: goto AeCH2; AeCH2: } goto jQSAo; sMP60: $conditions["\163\164\141\x74\x75\x73"] = $search["\163\164\x61\x74\165\x73"]; goto G5yc2; gRdhW: $order = "\x69\x64\x20\141\163\143"; goto dExgo; wPceO: if (emptyInArray($search, "\x64\x65\x6c\x65\164\145\137\146\154\141\147")) { goto oCRhM; } goto g1bC2; e4f5D: } public function add($infos) { goto MLE6i; px8VD: UIh74: goto X_AMN; HbL3w: $targetIds = $infos["\x74\141\162\x67\x65\x74"]; goto U1VWn; X_AMN: $targetIds = []; goto WtZE8; Phg7g: $categoryIds = []; goto fRhOO; V0ply: foreach ($targetIds as $targetId) { Db::table("\x65\x78\160\x65\162\x74\x5f\164\141\162\147\145\x74\137\162\145\154\x61\164\145")->insert(["\x65\x78\160\x65\162\164\137\x69\x64" => $expertId, "\x74\141\162\x67\x65\x74\x5f\x69\144" => $targetId]); l4kEU: } goto m_10f; elI5D: NMFde: goto GFbOy; b0qmk: return true; goto OYYLH; xAx7v: kA2th: goto bJ59I; U1VWn: qXTg4: goto V0ply; fRhOO: if (!(isset($infos["\143\x61\164\x65\147\x6f\162\171"]) && $infos["\143\x61\164\145\147\x6f\162\x79"])) { goto jkEeM; } goto OzeGd; ilUVB: $expertId = $model->id; goto Phg7g; WtZE8: if (!(isset($infos["\164\141\162\x67\145\x74"]) && $infos["\x74\141\162\x67\145\x74"])) { goto qXTg4; } goto HbL3w; DBvB8: foreach ($categoryIds as $categoryId) { Db::table("\145\170\x70\x65\162\x74\x5f\x63\141\x74\145\147\157\x72\x79\x5f\162\145\x6c\141\x74\145")->insert(["\x65\x78\x70\x65\162\164\x5f\151\x64" => $expertId, "\143\141\164\x65\x67\x6f\x72\171\x5f\151\144" => $categoryId]); MYeKa: } goto px8VD; F1f2Y: $fields = []; goto wKHtU; bJ59I: OperationLogs::I()->expertLog("\346\226\xb0\xe5\242\x9e\xe4\xb8\x93\xe5\xae\266\x20\55\x20{$model->real_name}", beautifyLogArray($infos, [], "\145\170\x70\x65\x72\x74"), OperationLogs::OPT_ADD_TYPE, $expertId); goto b0qmk; m_10f: pwuJO: goto F1f2Y; GFbOy: foreach ($fields as $fieldId => $fieldItems) { goto gwn8L; hpoV2: NeY83: goto Oma6Y; Oma6Y: RiOJ4: goto s6JU1; gwn8L: foreach ($fieldItems as $fieldItemId) { Db::table("\145\x78\x70\x65\162\x74\137\146\x69\145\x6c\144\x5f\x72\x65\154\x61\164\145")->insert(["\145\x78\x70\x65\x72\164\137\151\x64" => $expertId, "\146\x69\x65\154\x64\137\x69\144" => $fieldId, "\x66\x69\x65\154\x64\x5f\151\x74\145\155\x5f\x69\x64" => $fieldItemId]); f8ETr: } goto hpoV2; s6JU1: } goto xAx7v; dVC__: $fields = $infos["\x66\151\145\154\144"]; goto elI5D; wKHtU: if (!(isset($infos["\x66\x69\x65\x6c\144"]) && $infos["\146\x69\145\154\144"])) { goto NMFde; } goto dVC__; OzeGd: $categoryIds = $infos["\143\x61\164\x65\147\x6f\x72\x79"]; goto gAzmN; MLE6i: $model = model("\105\170\160\145\162\164"); goto j5afH; gAzmN: jkEeM: goto DBvB8; J5W6b: $model->allowField(true)->save(); goto ilUVB; nC9C2: $model->data($infos); goto J5W6b; j5afH: $infos["\146\151\x72\x73\164\x5f\152\x6f\142\x5f\x74\151\155\x65"] = !emptyInArray($infos, "\146\151\162\163\164\x5f\152\x6f\142\137\x74\151\155\x65") ? $infos["\146\151\162\x73\164\x5f\152\157\x62\x5f\164\151\x6d\x65"] : null; goto nC9C2; OYYLH: } public function edit($expertId, $infos) { goto S725z; Fd0P_: foreach ($targetIds as $targetId) { Db::table("\x65\x78\x70\145\x72\x74\x5f\164\141\x72\x67\145\164\137\x72\x65\154\x61\164\x65")->insert(["\145\170\x70\x65\x72\x74\137\x69\144" => $expertId, "\164\141\162\147\x65\x74\137\x69\x64" => $targetId]); C2NsM: } goto kr8nH; EjwVU: $model->allowField(true)->save(); goto hZHAF; vXSEE: $model->data($infos); goto EjwVU; DB7Lt: $targetIds = $infos["\164\x61\162\x67\145\164"]; goto U2FVx; jJIiZ: exception("\346\227\240\xe6\xb3\225\xe6\211\276\xe5\x88\xb0\xe8\xaf\xa5\344\xb8\223\345\xae\266"); goto JawAU; hZHAF: $categoryIds = []; goto R1Wro; eZsih: Db::table("\x65\x78\x70\145\162\x74\x5f\146\151\x65\154\x64\x5f\x72\145\x6c\x61\164\x65")->where(["\145\170\160\x65\x72\x74\x5f\151\x64" => $expertId])->delete(); goto zZn7g; ja9Bp: Db::table("\x65\x78\x70\145\162\164\137\143\141\164\x65\147\x6f\x72\x79\137\162\x65\x6c\x61\x74\145")->where(["\x65\x78\x70\145\162\164\x5f\x69\x64" => $expertId])->delete(); goto jWrWn; VTAwq: if (!(isset($infos["\164\141\162\x67\145\164"]) && $infos["\x74\x61\162\x67\x65\164"])) { goto KfViE; } goto DB7Lt; U9Nu1: $fields = $infos["\x66\x69\145\x6c\144"]; goto jSmoc; S725z: $model = ExpertModel::get($expertId); goto QHw22; ow_Qz: $originals = Db::table("\145\x78\160\145\162\x74")->where(["\x69\144" => $expertId])->field(true)->find(); goto RjyoA; Ig9SW: $categoryIds = $infos["\143\141\x74\x65\147\157\162\x79"]; goto OQwTC; E3YG0: bq2ij: goto ow_Qz; kr8nH: lBrkC: goto pK2pb; HDc8n: $infos["\155\x6f\144\x69\146\x79\137\164\151\155\x65"] = date("\131\55\155\x2d\144\x20\110\x3a\151\x3a\163"); goto vXSEE; TrVgq: $targetIds = []; goto VTAwq; R1Wro: if (!(isset($infos["\x63\141\x74\145\x67\157\162\171"]) && $infos["\143\141\164\145\147\x6f\162\x79"])) { goto OxL8B; } goto Ig9SW; jWrWn: foreach ($categoryIds as $categoryId) { Db::table("\145\170\x70\145\x72\164\137\x63\x61\164\145\147\157\x72\x79\137\162\x65\154\x61\x74\145")->insert(["\x65\170\x70\145\162\x74\x5f\151\144" => $expertId, "\x63\141\164\x65\x67\x6f\x72\x79\x5f\151\x64" => $categoryId]); Qj7UT: } goto eYFAY; eYFAY: H0f6F: goto TrVgq; LR_QA: Db::table("\145\170\x70\145\x72\x74\x5f\164\141\x72\147\145\x74\x5f\162\x65\x6c\141\x74\x65")->where(["\x65\170\x70\x65\162\x74\x5f\151\x64" => $expertId])->delete(); goto Fd0P_; jSmoc: zGPs0: goto eZsih; JawAU: return; goto E3YG0; nzuNk: OperationLogs::I()->expertLog("\344\xbf\256\346\x94\271\344\270\223\xe5\256\xb6\40\55\40{$model->real_name}", beautifyLogArray($infos, $originals, "\145\x78\160\x65\162\x74"), OperationLogs::OPT_UPDATE_TYPE, $expertId); goto g3d12; RjyoA: $infos["\146\151\x72\x73\164\137\x6a\157\142\137\164\151\x6d\x65"] = !emptyInArray($infos, "\x66\x69\162\163\164\x5f\152\x6f\142\x5f\x74\x69\155\145") ? $infos["\146\151\x72\x73\x74\137\152\157\x62\x5f\x74\x69\x6d\145"] : null; goto HDc8n; OQwTC: OxL8B: goto ja9Bp; U2FVx: KfViE: goto LR_QA; w3332: A5iy2: goto nzuNk; pK2pb: $fields = []; goto Xyzzf; QHw22: if ($model) { goto bq2ij; } goto jJIiZ; Xyzzf: if (!(isset($infos["\146\x69\145\x6c\144"]) && $infos["\146\x69\145\x6c\144"])) { goto zGPs0; } goto U9Nu1; zZn7g: foreach ($fields as $fieldId => $fieldItems) { goto il68n; O6lvG: pa23G: goto LlC0a; il68n: foreach ($fieldItems as $fieldItemId) { Db::table("\145\170\x70\145\162\164\137\146\x69\x65\x6c\144\137\x72\x65\154\141\164\145")->insert(["\x65\170\160\x65\162\x74\x5f\x69\144" => $expertId, "\146\x69\x65\x6c\x64\x5f\x69\144" => $fieldId, "\146\x69\x65\x6c\144\137\x69\x74\x65\155\x5f\x69\144" => $fieldItemId]); ZVuOv: } goto O6lvG; LlC0a: DzyyI: goto pUFS4; pUFS4: } goto w3332; g3d12: } public function delete($expertId) { goto tnoJQ; T0heR: OperationLogs::I()->expertLog("\345\210\240\351\231\244\344\270\223\345\256\266", $model->real_name, OperationLogs::OPT_DELETE_TYPE, $expertId); goto gQ3NL; u1hMM: wk9q0: goto rKGRv; FPH4b: if ($model) { goto wk9q0; } goto ZjtEn; tnoJQ: $model = ExpertModel::get($expertId); goto FPH4b; gn3ra: goto TwgCx; goto u1hMM; rKGRv: $model->save(["\x64\x65\154\145\x74\145\137\x66\x6c\141\x67" => 1]); goto T0heR; ZjtEn: exception("\xe6\x97\xa0\346\263\x95\346\211\xbe\345\210\xb0\xe8\257\245\xe4\270\223\345\256\266"); goto gn3ra; gQ3NL: TwgCx: goto LKICI; LKICI: } public function restore($expertId) { goto SNcGO; tVCB7: goto Wp4AV; goto Auyrk; SJAJR: $model->save(["\x64\x65\154\x65\x74\145\137\146\x6c\141\147" => 0]); goto Yz4FL; fzfFT: exception("\xe6\x97\xa0\346\263\225\xe6\211\xbe\xe5\x88\260\350\xaf\245\xe4\270\x93\xe5\256\266"); goto tVCB7; Auyrk: GsuqR: goto SJAJR; SNcGO: $model = ExpertModel::get($expertId); goto PP_pa; Yz4FL: OperationLogs::I()->expertLog("\346\201\242\345\244\x8d\344\270\223\345\xae\xb6", $model->real_name, OperationLogs::OPT_RESTORE_TYPE, $expertId); goto C2GXn; PP_pa: if ($model) { goto GsuqR; } goto fzfFT; C2GXn: Wp4AV: goto Sscim; Sscim: } public function deleteForce($expertId) { goto FbBqP; V4ScA: Db::table("\145\170\x70\145\x72\164")->where("\x69\x64", $expertId)->delete(); goto B77PV; iOgL9: Db::table("\145\x78\x70\x65\x72\x74\x5f\x66\x69\x65\154\144\x5f\162\145\x6c\141\164\145")->where(["\x65\170\x70\x65\x72\164\137\x69\144" => $expertId])->delete(); goto TYAHP; lXCqz: Db::table("\145\170\x70\x65\x72\x74\x5f\164\x61\x72\147\x65\x74\137\x72\x65\x6c\x61\x74\145")->where(["\145\170\x70\145\x72\164\x5f\x69\144" => $expertId])->delete(); goto iOgL9; FbBqP: Db::table("\145\x78\x70\145\162\x74\x5f\x63\x61\164\145\147\x6f\x72\171\137\162\x65\154\141\164\145")->where(["\x65\170\160\145\x72\164\137\151\144" => $expertId])->delete(); goto lXCqz; HLvto: Db::table("\145\170\160\x65\x72\164\x5f\157\x72\144\x65\x72")->where(["\145\170\160\x65\162\164\x5f\151\144" => $expertId])->delete(); goto V4ScA; TYAHP: Db::table("\145\170\x70\145\162\164\x5f\x61\x70\160\x6f\151\x6e\x74\x5f\164\151\x6d\145")->where(["\145\x78\x70\x65\x72\x74\x5f\151\144" => $expertId])->delete(); goto HLvto; B77PV: } public function getInfos($expertId) { goto jhcN1; ah6YW: $infos["\x61\x70\x70\x6f\x69\156\164\137\x64\141\171\x5f\x74\x69\x6d\x65\x73"] = Db::table("\145\x78\x70\145\162\164\x5f\x61\x70\160\x6f\x69\156\164\137\164\151\x6d\145")->where(["\x65\170\x70\145\162\164\137\151\144" => $expertId])->field("\x77\x65\x65\x6b\x5f\144\141\x79\54\40\x61\160\160\157\151\x6e\x74\137\164\151\155\x65")->select(); goto MN021; KPkNb: $infos["\143\x61\x74\145\147\157\162\x79\x49\144\163"] = Db::table("\145\170\x70\145\162\164\x5f\143\141\x74\x65\147\x6f\162\171\x5f\x72\x65\x6c\x61\164\x65")->where(["\x65\x78\160\145\162\164\137\151\144" => $expertId])->column("\143\141\x74\x65\x67\x6f\162\171\x5f\x69\144"); goto uZKPT; MN021: return $infos; goto LHOua; jhcN1: $infos = Db::table("\145\170\160\x65\162\x74")->where("\151\144", $expertId)->field(true)->find(); goto XWL10; XWL10: if ($infos) { goto rIqjm; } goto MHW0B; MHW0B: return false; goto NbwBU; NbwBU: rIqjm: goto KPkNb; f38qY: $infos["\146\x69\x65\x6c\x64\111\x74\x65\x6d\111\144\x73"] = Db::table("\x65\x78\160\x65\x72\x74\137\x66\x69\145\154\144\x5f\x72\145\154\x61\164\x65")->where(["\x65\170\160\145\162\164\x5f\x69\144" => $expertId])->column("\146\x69\x65\x6c\x64\137\151\164\x65\x6d\137\x69\x64"); goto ah6YW; uZKPT: $infos["\164\x61\x72\x67\x65\164\x49\x64\x73"] = Db::table("\145\x78\x70\x65\162\164\x5f\x74\x61\162\x67\145\164\x5f\x72\x65\x6c\x61\164\145")->where(["\145\x78\x70\x65\x72\x74\x5f\151\144" => $expertId])->column("\164\x61\x72\x67\x65\164\x5f\x69\x64"); goto f38qY; LHOua: } public function getDefaultInfos() { return ["\162\145\141\x6c\137\156\141\155\145" => '', "\x77\157\162\x6b\151\x6d\x67\x5f\165\162\154" => '', "\x63\x61\x74\x65\147\x6f\162\171\x49\144\x73" => [], "\x63\x65\154\x6c\160\150\x6f\156\x65" => null, "\146\x69\x72\163\164\x5f\x6a\157\x62\137\164\x69\x6d\145" => null, "\167\157\x72\153\x70\154\141\143\145" => null, "\145\170\x70\145\x72\x74\x5f\x70\x72\157\146\x69\x6c\145" => '', "\x65\x78\160\145\162\164\137\x71\x75\141\154\x69\164\x79" => null, "\x63\157\156\163\x75\x6c\x74\x5f\x71\165\x61\156\x74\151\164\x79" => 500, "\146\151\145\x6c\144\111\x74\145\155\x49\x64\163" => [], "\164\141\162\147\x65\x74\x49\x64\163" => [], "\141\160\160\157\151\x6e\164\137\146\x65\145" => 0.0, "\x61\x70\x70\157\151\156\164\x5f\x72\145\x76\x69\145\167\x5f\x66\145\x65" => 0.0, "\x72\x65\x6d\141\x72\153" => null, "\141\x70\160\x6f\151\x6e\164\137\144\x61\x79\x5f\x74\x69\x6d\145\x73" => [], "\x73\164\141\x74\165\163" => IndexDefs::ENTITY_DRAFT_STATUS]; } public function qrcode($id) { goto Nm0LJ; xdmK4: $result = file_put_contents(SITE_DIR . $path, file_get_contents($url)); goto aXuDt; Nm0LJ: $expert = $this->getInfos($id); goto TByd0; a8s5M: wexception("\347\224\x9f\xe6\x88\x90\xe5\xa4\xb1\350\264\245\xef\xbc\232\346\234\xaa\xe9\205\215\xe7\xbd\xae\xe5\205\xac\xe4\274\227\xe5\217\xb7\345\x8f\202\346\x95\xb0"); goto FkiWd; JWhB6: $scene_id = "\145\170\x70\145\x72\164\137\151\x64\x5f" . $id; goto h3LqH; IJGyW: wexception("\346\227\xa0\346\263\x95\xe6\211\xbe\345\210\xb0\350\xaf\xa5\344\xb8\x93\xe5\256\xb6"); goto gp2YA; rrvpI: Db::table("\x65\170\x70\145\162\164")->where(["\151\x64" => $id])->setField("\161\x72\143\x6f\x64\145", $path); goto v1y5v; kGVZt: if (systemSetting("\127\x58\x5f\x4f\x46\106\111\103\105\x5f\101\x43\x43\117\x55\x4e\x54\137\x41\x50\120\137\111\x44")) { goto lBR3L; } goto a8s5M; TByd0: if ($expert) { goto zp89B; } goto IJGyW; h3LqH: try { goto JMxxl; Al3CF: Zqfkq: goto VcOiv; l1_eD: exception("\346\216\245\345\217\243\350\xbf\224\xe5\233\236\345\xa4\261\350\264\245\x2c\x20" . var_export($res, true)); goto Al3CF; JMxxl: $res = $app->qrcode->forever($scene_id); goto eRslZ; cmJsq: OvybA: goto J4rRZ; MiYug: Log::notice("\x65\x78\x70\145\x72\164\x20\161\x72\x63\x6f\x64\145\x20\x72\145\164\x75\x72\156\40" . var_export($res, true)); goto cmJsq; J4rRZ: if (!(!$res || !isset($res["\164\151\x63\153\145\164"]))) { goto Zqfkq; } goto l1_eD; eRslZ: if (!$res) { goto OvybA; } goto MiYug; VcOiv: $url = $app->qrcode->url($res["\x74\151\143\153\x65\x74"]); goto CShXM; CShXM: } catch (\Exception $e) { wexception("\347\x94\x9f\346\210\x90\345\xa4\xb1\xe8\264\245\357\274\x9a" . $e->getMessage()); } goto NHs9d; NHs9d: $path = "\x2f\x71\162\x63\x6f\144\145\57" . $scene_id . "\56\152\160\147"; goto xdmK4; aXuDt: if ($result) { goto Gi5mH; } goto XPGj0; XPGj0: wexception("\345\206\x99\345\x85\245\xe5\233\xbe\xe5\x83\217\xe6\226\x87\344\xbb\266\xe5\244\xb1\350\264\245"); goto VwaaD; v1y5v: return $path; goto UOmQY; upsgM: $app = \EasyWeChat\Factory::officialAccount(config("\x77\x78\x2e\x6f\146\x66\x69\143\x69\141\x6c\137\x61\143\x63\157\165\x6e\x74")); goto JWhB6; FkiWd: lBR3L: goto xV285; VwaaD: Gi5mH: goto rrvpI; gp2YA: zp89B: goto kGVZt; xV285: wxPaySetting(); goto upsgM; UOmQY: } public function set45AppointTime($expertId, $weekDay, $intervals) { goto c1PWH; lR4RU: $existAppointTimes = []; goto Bby1Z; wpC6F: wexception("\xe6\227\240\xe6\263\225\xe6\211\276\345\x88\xb0\xe8\xaf\245\xe4\270\223\xe5\256\266"); goto XrKvQ; c1PWH: sort($intervals, SORT_STRING); goto p29e8; iWNUr: if (!$bConflict) { goto qbvSQ; } goto yYOHQ; yYOHQ: wexception("\346\x89\200\xe9\x80\211\347\232\x84\346\x97\266\351\227\264\xe5\x9d\227\xe8\xa2\253\345\x8d\240\xe7\224\xa8"); goto HT6S6; MS0fT: wexception("\xe8\257\xb7\351\x80\211\xe6\x8b\251\x33\344\xb8\xaa\350\277\236\xe7\xbb\255\xe6\x97\xb6\351\227\xb4\345\x9d\227"); goto dY8Gg; y8MTx: Db::table("\145\x78\160\145\162\164\137\141\x70\160\x6f\x69\156\164\x5f\x74\x69\x6d\145")->insert(["\145\x78\160\x65\x72\164\137\x69\x64" => $expertId, "\167\145\145\x6b\137\144\x61\171" => $weekDay, "\141\160\160\157\151\156\x74\137\x74\x69\x6d\x65" => implode("\x2c", $intervals)]); goto P6VwN; pArnv: $bConflict = false; goto ZZPlZ; jRcGN: qN1R2: goto iWNUr; ufsC2: rkoez: goto nW3M3; ZKjOt: if ($sections0[1] == $sections1[0] && $sections1[1] == $sections2[0]) { goto rt5W5; } goto mo7XB; eiXSS: goto rkoez; goto nk6uy; Bby1Z: $appointTimes = Db::table("\145\x78\160\145\162\x74\137\141\160\160\157\151\156\164\137\x74\151\155\x65")->where(["\145\170\160\145\162\164\137\151\x64" => $expertId, "\167\145\x65\153\x5f\144\x61\171" => $weekDay])->column("\141\x70\160\157\x69\156\x74\137\164\151\x6d\145"); goto U3Axs; U3Axs: foreach ($appointTimes as $appointTime) { $existAppointTimes = array_merge($existAppointTimes, explode("\54", $appointTime)); AIR2o: } goto XmBGa; XrKvQ: Rkho7: goto lR4RU; XmBGa: au_jC: goto pArnv; HT6S6: qbvSQ: goto y8MTx; p29e8: if (!(count($intervals) != 3)) { goto o9dhN; } goto MS0fT; nk6uy: rt5W5: goto ufsC2; ZZPlZ: foreach ($intervals as $interval) { goto cEnD0; ZzZHi: xA0hA: goto IHk0o; iLhvI: $bConflict = true; goto bqowy; ByqfC: bDICO: goto ZzZHi; cEnD0: if (!in_array($interval, $existAppointTimes)) { goto bDICO; } goto iLhvI; bqowy: goto qN1R2; goto ByqfC; IHk0o: } goto jRcGN; MrGrq: if ($infos) { goto Rkho7; } goto wpC6F; dY8Gg: o9dhN: goto Ssy5z; mo7XB: wexception("\xe8\257\xb7\xe9\x80\x89\xe6\213\xa9\x33\344\270\xaa\350\277\236\xe7\xbb\xad\346\x97\xb6\351\227\264\xe5\235\x97"); goto eiXSS; Ssy5z: $sections0 = explode("\55", $intervals[0]); goto OM_sb; XcOvV: $sections2 = explode("\55", $intervals[2]); goto ZKjOt; OM_sb: $sections1 = explode("\55", $intervals[1]); goto XcOvV; nW3M3: $infos = $this->getInfos($expertId); goto MrGrq; P6VwN: } public function set15AppointTime($expertId, $weekDay, $intervals) { goto Bc5aS; SQxHa: Pgw0h: goto HKbfU; UIEsu: Db::table("\x65\x78\160\x65\162\164\137\x61\x70\160\x6f\151\x6e\x74\137\x74\151\155\145")->insert(["\x65\170\x70\x65\162\164\x5f\151\144" => $expertId, "\x77\145\x65\x6b\137\144\141\x79" => $weekDay, "\x61\160\x70\x6f\151\156\x74\x5f\x74\151\x6d\145" => implode("\54", $intervals)]); goto Wlsx7; HKbfU: if (!$bConflict) { goto CYe5x; } goto jkqpE; Mjdur: $bConflict = false; goto l4ALB; DMDuf: if ($infos) { goto j036m; } goto WZcnt; WZcnt: wexception("\xe6\227\240\346\xb3\x95\xe6\211\xbe\xe5\x88\xb0\xe8\257\245\xe4\270\223\345\xae\xb6"); goto uJLyW; l4ALB: foreach ($intervals as $interval) { goto ql6qu; WXNIM: goto Pgw0h; goto nZHiV; ZsBP1: $bConflict = true; goto WXNIM; ql6qu: if (!in_array($interval, $existAppointTimes)) { goto zqqGe; } goto ZsBP1; nZHiV: zqqGe: goto f6AVE; f6AVE: eaVjp: goto KprZ4; KprZ4: } goto SQxHa; X8Mks: wexception("\350\257\xb7\351\x80\211\346\x8b\xa9\61\xe4\270\xaa\346\x97\266\xe9\227\264\345\235\x97"); goto lNSMh; lNSMh: q0Bmr: goto FA6h9; UudhK: CYe5x: goto UIEsu; jkqpE: wexception("\xe6\x89\200\xe9\x80\211\xe7\232\x84\xe6\x97\266\xe9\x97\xb4\345\235\x97\xe8\242\xab\xe5\x8d\xa0\347\x94\xa8"); goto UudhK; FA6h9: $infos = $this->getInfos($expertId); goto DMDuf; ztFC1: $appointTimes = Db::table("\x65\x78\160\x65\x72\164\137\141\x70\160\157\151\156\x74\137\x74\x69\x6d\x65")->where(["\145\170\160\x65\x72\x74\x5f\151\x64" => $expertId, "\167\x65\145\x6b\x5f\x64\141\x79" => $weekDay])->column("\x61\x70\160\157\x69\x6e\164\137\x74\x69\155\145"); goto Zo7jO; Bc5aS: if (!(count($intervals) != 1)) { goto q0Bmr; } goto X8Mks; GmCLK: $existAppointTimes = []; goto ztFC1; dcSuv: Y65Ik: goto Mjdur; Zo7jO: foreach ($appointTimes as $appointTime) { $existAppointTimes = array_merge($existAppointTimes, explode("\x2c", $appointTime)); hseqY: } goto dcSuv; uJLyW: j036m: goto GmCLK; Wlsx7: } public function cancelAppointTime($expertId, $weekDay, $intervals) { goto ZNIVX; fAGFF: $existAppointTime = Db::table("\145\170\160\145\162\164\x5f\x61\x70\x70\157\x69\156\x74\137\x74\x69\x6d\145")->where(["\x65\x78\x70\145\162\x74\x5f\x69\x64" => $expertId, "\167\x65\x65\x6b\137\144\x61\x79" => $weekDay, "\x61\160\160\x6f\x69\x6e\164\x5f\x74\x69\x6d\145" => implode("\54", $intervals)])->find(); goto TwEs4; TwEs4: if ($existAppointTime) { goto fdbMW; } goto uitR3; xNngE: if (!(count($intervals) != 1 && count($intervals) != 3)) { goto SnAXa; } goto VgVwK; ZNIVX: sort($intervals, SORT_STRING); goto xNngE; VgVwK: wexception("\xe8\xaf\xb7\xe5\256\x8c\346\225\xb4\xe9\x80\211\346\x8b\251\x34\x35\345\210\206\xe9\x92\x9f\63\344\270\xaa\xe8\xbf\x9e\xe7\xbb\xad\346\x97\266\xe9\227\xb4\xe5\x9d\227\x2f\x31\x35\345\210\x86\xe9\222\x9f\61\xe4\270\xaa\xe6\227\xb6\351\227\264\xe5\x9d\227"); goto VaWCX; bsCUL: fdbMW: goto b7Z7C; b7Z7C: Db::table("\145\x78\x70\145\x72\x74\x5f\x61\x70\x70\157\x69\x6e\x74\x5f\x74\x69\x6d\x65")->where(["\x65\x78\160\x65\162\164\x5f\x69\x64" => $expertId, "\167\145\x65\153\x5f\144\141\171" => $weekDay, "\x61\x70\x70\157\x69\x6e\164\137\x74\x69\x6d\145" => implode("\54", $intervals)])->delete(); goto KLJel; uitR3: wexception("\346\211\x80\351\200\211\xe6\x8b\251\xe5\x8f\x96\346\xb6\210\xe7\x9a\x84\346\227\266\xe9\227\xb4\xe6\xae\xb5\xe4\xb8\215\xe5\255\x98\345\234\250"); goto bsCUL; VaWCX: SnAXa: goto fAGFF; KLJel: } public function defaultSchedule($expertId, $weekDay) { goto B1R8i; QJQiR: tw4py: goto hAYu6; DhmGb: Db::table("\145\x78\160\145\x72\x74\137\141\160\160\x6f\151\156\164\x5f\x74\x69\155\145")->insert(["\145\170\160\x65\162\x74\x5f\151\144" => $expertId, "\x77\x65\x65\x6b\x5f\144\x61\171" => $weekDay, "\141\160\x70\157\x69\x6e\164\137\x74\x69\155\x65" => $appointInterval]); goto TSxU2; r4Oc1: goto OKr0C; goto a2muu; YMh0F: $nextHour = date("\x48\72\x69", strtotime($nowDate . "\40" . $startHour . "\72\60\60" . "\x20\53\x31\x35\x20\155\151\156\165\x74\x65\163")); goto KRY1U; d1ebf: $startHour = IndexDefs::APPOINT_START_TIME; goto Q4ZLa; hAYu6: $appoint45s[] = $appointInterval; goto JZMB_; uPs3Y: Db::table("\145\x78\x70\145\x72\164\137\141\x70\160\157\x69\x6e\x74\x5f\164\151\x6d\x65")->insert(["\145\x78\160\145\162\x74\x5f\x69\144" => $expertId, "\167\x65\x65\153\x5f\x64\x61\x79" => $weekDay, "\141\160\x70\157\x69\156\x74\137\x74\151\155\x65" => implode("\x2c", $appoint45s)]); goto RXNCg; b3PMl: if (!in_array($appointInterval, ["\61\x32\72\60\60\x2d\61\x32\72\61\65", "\x31\62\72\x31\65\55\x31\x32\72\x33\60", "\x31\62\72\63\60\55\x31\x32\x3a\x34\65", "\61\x32\x3a\x34\65\55\61\x33\x3a\x30\60", "\x31\63\x3a\x30\60\55\61\63\x3a\x31\65", "\x31\x33\x3a\61\65\55\x31\63\72\x33\x30", "\61\x33\72\x33\x30\x2d\61\63\x3a\x34\x35", "\x31\x33\72\x34\x35\x2d\61\64\72\x30\x30"])) { goto kL0BB; } goto vlKC2; JZMB_: guxEh: goto pzw1D; Q4ZLa: $endHour = IndexDefs::APPOINT_END_TIME; goto eRJ7m; RXNCg: array_splice($appoint45s, 0, count($appoint45s)); goto DhmGb; TSxU2: goto guxEh; goto QJQiR; w4Nic: $appoint45s = []; goto GeHqP; EJdNb: if (!($startHour < $endHour)) { goto WjtgK; } goto YMh0F; pzw1D: $startHour = $nextHour; goto r4Oc1; bJicW: goto OKr0C; goto faSVK; a2muu: WjtgK: goto qPFoF; B1R8i: Db::table("\145\x78\160\145\x72\164\137\x61\160\x70\x6f\151\156\164\x5f\164\x69\155\x65")->where(["\x65\170\x70\145\162\164\x5f\151\x64" => $expertId, "\x77\145\x65\x6b\x5f\x64\x61\x79" => $weekDay])->delete(); goto d1ebf; GeHqP: OKr0C: goto EJdNb; vlKC2: $startHour = $nextHour; goto bJicW; eRJ7m: $nowDate = date("\x59\55\x6d\55\x64"); goto w4Nic; faSVK: kL0BB: goto QvYkR; KRY1U: $appointInterval = $startHour . "\x2d" . $nextHour; goto b3PMl; QvYkR: if (count($appoint45s) < 3) { goto tw4py; } goto uPs3Y; qPFoF: } }
