<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\common\service\Storage as StorageService; use app\index\service\Wzyer as WzyerService; class License extends Base { const KEY = "\x79\x73\x73\107\67\70\110\110\x44\172\x76\67\125\x6d\x38\x56\x6b\107\x54\x45"; public function fetch() { goto qvKYz; VILjE: return $data; goto XU9J4; qvKYz: $data = ["\151\144" => null, "\x65\x6d\141\x69\154" => null, "\141\165\x74\x68\137\x6b\145\171" => null, "\142\151\x6e\x64\x5f\164\151\x6d\x65" => null, "\x76\151\160\137\x64\x75\x65\137\144\x61\164\x65" => null]; goto LJgm3; LJgm3: try { goto VUGIw; pmgpg: $data = array_merge($data, json_decode(xorEnde(base64_decode(StorageService::getInstance()->WZYER_AUTH), self::KEY), true)); goto aixYz; aixYz: tqSpX: goto ap7J6; VUGIw: if (!StorageService::getInstance()->WZYER_AUTH) { goto tqSpX; } goto pmgpg; ap7J6: } catch (\Exception $e) { StorageService::getInstance()->WZYER_AUTH = null; } goto VILjE; XU9J4: } public function getBuyUrl() { $licenseData = $this->fetch(); return "\x68\164\x74\x70\x73\x3a\57\57\167\x77\x77\56\167\172\x79\145\162\56\x63\157\155\x2f\x69\156\144\x65\x78\57\117\160\145\156\137\101\160\151\57\164\x6f\126\151\x70\56\x68\164\155\x6c\77\145\x6d\141\x69\154\x3d" . $licenseData["\x65\x6d\x61\x69\154"]; } public function bind($authKey) { goto UUpbN; A3hPn: $data = ["\x69\144" => $result["\151\144"], "\145\155\141\151\x6c" => $result["\145\155\x61\x69\154"], "\x61\x75\164\150\x5f\x6b\145\171" => $result["\x61\165\x74\x68\x5f\x6b\145\x79"], "\142\x69\x6e\144\137\164\151\x6d\x65" => date("\x59\55\155\55\144\40\x48\72\x69\72\163"), "\166\x69\160\137\144\x75\145\137\x64\141\164\145" => $result["\x76\151\160\x5f\144\x75\x65\x5f\144\x61\x74\145"]]; goto QjAmw; QjAmw: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto ODRox; UUpbN: $result = WzyerService::I()->bindAuthKey($authKey); goto A3hPn; ODRox: } public function unbind() { WzyerService::I()->unbindAuthKey(); StorageService::getInstance()->WZYER_AUTH = null; } public function refresh() { goto N2mkK; AnhJ4: $data = ["\x69\144" => $result["\151\144"], "\x65\x6d\141\151\154" => $result["\145\x6d\141\151\x6c"], "\x61\x75\164\x68\137\x6b\145\x79" => $result["\141\165\x74\x68\137\153\x65\171"], "\x62\x69\x6e\144\137\164\x69\155\x65" => $dataOld["\142\x69\x6e\x64\x5f\164\151\155\x65"] ?: date("\x59\x2d\155\x2d\x64\40\110\x3a\x69\x3a\163"), "\166\x69\x70\x5f\x64\x75\x65\137\144\141\164\145" => $result["\x76\151\x70\137\x64\x75\145\137\144\141\x74\145"]]; goto rrpkt; rrpkt: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto gfP0e; N2mkK: $dataOld = $this->fetch(); goto Kvr3w; Kvr3w: if (!empty($dataOld["\151\144"])) { goto ErIYy; } goto w4QX0; w4QX0: return; goto An9Zz; XR9Rp: $result = WzyerService::I()->refreshAuthKey(); goto AnhJ4; An9Zz: ErIYy: goto XR9Rp; gfP0e: } public function checkVip() { goto ktDY2; ktDY2: $data = $this->fetch(); goto zcAUM; gZfE3: hNJJH: goto XUUmW; AYf50: return false; goto ToRG0; x7_w5: return false; goto gZfE3; ToRG0: BX4Ag: goto bQaCJ; bQaCJ: return true; goto R9aO1; XUUmW: $today = date("\131\x2d\x6d\55\144"); goto J7iul; JrciJ: i0j1q: goto zn_Pu; J7iul: if (!($today > $data["\x76\151\160\x5f\x64\165\x65\137\x64\x61\x74\x65"])) { goto BX4Ag; } goto AYf50; bXKf2: return false; goto JrciJ; zn_Pu: if (!empty($data["\x76\151\x70\137\x64\x75\145\137\x64\x61\164\145"])) { goto hNJJH; } goto x7_w5; zcAUM: if (!empty($data["\x69\144"])) { goto i0j1q; } goto bXKf2; R9aO1: } }
