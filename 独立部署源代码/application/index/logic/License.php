<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\common\service\Storage as StorageService; use app\index\service\Wzyer as WzyerService; class License extends Base { const KEY = "\171\163\163\x47\x37\70\x48\x48\x44\x7a\x76\67\x55\x6d\70\x56\153\107\124\105"; public function fetch() { goto Fg7s5; MuTW1: return $data; goto b2qcd; Fg7s5: $data = ["\151\144" => null, "\x65\155\141\x69\154" => null, "\141\165\164\x68\137\153\145\x79" => null, "\142\151\156\x64\x5f\164\x69\x6d\145" => null, "\x76\151\160\x5f\x64\x75\145\x5f\x64\x61\164\x65" => null]; goto HaQc_; HaQc_: try { goto vA4V6; igI5b: $data = array_merge($data, json_decode(xorEnde(base64_decode(StorageService::getInstance()->WZYER_AUTH), self::KEY), true)); goto YONyj; YONyj: K4vH4: goto h58Q6; vA4V6: if (!StorageService::getInstance()->WZYER_AUTH) { goto K4vH4; } goto igI5b; h58Q6: } catch (\Exception $e) { StorageService::getInstance()->WZYER_AUTH = null; } goto MuTW1; b2qcd: } public function getBuyUrl() { $licenseData = $this->fetch(); return "\150\x74\x74\160\163\72\x2f\57\x77\x77\167\56\167\x7a\x79\145\x72\56\143\x6f\155\x2f\151\156\144\x65\170\x2f\117\160\145\x6e\137\101\160\151\x2f\164\157\x56\151\160\56\x68\164\x6d\154\x3f\145\155\141\x69\154\75" . $licenseData["\x65\x6d\141\151\x6c"]; } public function bind($authKey) { goto S_6nO; MlYu8: $data = ["\x69\x64" => $result["\x69\x64"], "\x65\155\141\x69\x6c" => $result["\145\x6d\x61\151\154"], "\141\165\x74\x68\x5f\x6b\x65\x79" => $result["\141\165\x74\x68\x5f\153\145\x79"], "\x62\151\x6e\144\137\x74\151\x6d\x65" => date("\x59\x2d\x6d\x2d\144\x20\110\72\151\72\x73"), "\x76\151\x70\x5f\x64\x75\145\x5f\144\141\x74\x65" => $result["\166\x69\x70\x5f\144\x75\x65\137\144\x61\164\145"]]; goto XDsBK; XDsBK: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto GsS1S; S_6nO: $result = WzyerService::I()->bindAuthKey($authKey); goto MlYu8; GsS1S: } public function unbind() { WzyerService::I()->unbindAuthKey(); StorageService::getInstance()->WZYER_AUTH = null; } public function refresh() { goto kwMUv; Qjt4G: $data = ["\151\144" => $result["\x69\x64"], "\145\x6d\141\151\x6c" => $result["\145\155\141\151\154"], "\141\x75\x74\x68\x5f\x6b\x65\171" => $result["\x61\165\164\150\137\x6b\x65\171"], "\142\x69\x6e\144\137\164\151\155\145" => $dataOld["\x62\151\x6e\x64\137\x74\x69\x6d\145"] ?: date("\131\55\x6d\x2d\x64\40\110\x3a\151\x3a\163"), "\166\x69\x70\137\144\165\145\137\144\141\x74\145" => $result["\x76\151\x70\x5f\x64\165\145\x5f\144\141\164\x65"]]; goto VXkm_; nWgLJ: B4wQU: goto IhJ2c; IhJ2c: $result = WzyerService::I()->refreshAuthKey(); goto Qjt4G; fEswq: if (!empty($dataOld["\x69\144"])) { goto B4wQU; } goto bjLuD; kwMUv: $dataOld = $this->fetch(); goto fEswq; bjLuD: return; goto nWgLJ; VXkm_: StorageService::getInstance()->WZYER_AUTH = base64_encode(xorEnde(json_encode($data), self::KEY)); goto f55cF; f55cF: } public function checkVip() { goto YPMOf; w07CQ: if (!($today > $data["\x76\151\160\x5f\144\x75\145\x5f\x64\x61\164\145"])) { goto yQof0; } goto xf81o; cqWMj: $today = date("\131\x2d\155\55\144"); goto w07CQ; V3tmb: return true; goto P2C13; itW1I: gIeer: goto cqWMj; mJejg: if (!empty($data["\166\151\x70\x5f\x64\x75\x65\137\144\141\x74\145"])) { goto gIeer; } goto cbPtx; cbPtx: return false; goto itW1I; gVvPa: if (!empty($data["\x69\x64"])) { goto RQUlR; } goto xlWqy; xf81o: return false; goto U_vi9; qybGg: RQUlR: goto mJejg; U_vi9: yQof0: goto V3tmb; YPMOf: $data = $this->fetch(); goto gVvPa; xlWqy: return false; goto qybGg; P2C13: } }
