<?php
 namespace app\index\logic; use app\index\model\Setting; use think\Debug; use think\Db; use think\Log; use think\Request; use think\Session; use app\index\logic\Defs as IndexDefs; use app\index\service\EventLogs; use app\Defs; use app\index\model\Customer as CustomerModel; use app\index\service\RequestContext; class Customer extends Base { protected function __construct() { parent::__construct(); } public function load($search = array(), $page = 1, $rows = DEFAULT_PAGE_ROWS, $sort = '', $order = '') { goto VNjXS; gf4Ym: $totalCount = Db::table("\x63\165\x73\164\x6f\x6d\145\x72")->where($conditions)->count(); goto NeLxS; BQbeU: if (emptyInArray($search, "\x63\x68\141\x6e\156\145\x6c\x5f\x69\144")) { goto esTMS; } goto fk3v4; g5UH1: Fo4wx: goto Bm9HV; VNjXS: if (in_array($sort, ["\162\145\x67\x69\x73\164\x65\x72\137\164\x69\x6d\145", "\164\157\164\141\x6c\137\164\145\x73\x74\x5f\x71\x75\x61\156\164\x69\164\x79", "\x74\157\164\x61\154\x5f\164\145\x73\x74\x5f\x61\155\157\165\156\x74", "\x74\x6f\x74\x61\154\x5f\141\160\x70\157\151\156\x74\x5f\161\165\x61\x6e\x74\151\x74\171", "\154\x61\x74\145\163\x74\137\154\x6f\x67\151\x6e\137\164\151\155\x65"])) { goto nlS3f; } goto RCZgf; xi1Wk: $order = $sort . "\x20" . $order; goto kSAgu; BaCJQ: $conditions["\157\x72\147\141\x6e\151\x7a\141\164\151\x6f\156\x5f\x69\x64"] = $search["\x6f\x72\x67\x61\x6e\151\x7a\141\x74\151\x6f\156\x5f\151\144"]; goto aOg1n; SxdWV: $conditions["\162\145\141\x6c\x5f\x6e\141\155\x65"] = ["\x6c\151\x6b\145", "\45" . $search["\162\145\x61\154\x5f\156\141\x6d\145"] . "\x25"]; goto g5UH1; QM4ud: goto PO02E; goto BuSw8; Bm9HV: if (emptyInArray($search, "\143\x65\154\154\x70\150\157\156\x65")) { goto uH2rM; } goto ZO91U; fk3v4: $conditions["\143\150\x61\x6e\156\x65\x6c\137\151\144"] = $search["\x63\150\x61\x6e\156\x65\154\137\x69\144"]; goto qvD3w; aOg1n: YYXUb: goto gf4Ym; CHG1E: O9EwB: goto qPpml; q6xaG: if (emptyInArray($search, "\157\162\147\x61\156\x69\172\141\x74\x69\x6f\156\137\151\144")) { goto YYXUb; } goto BaCJQ; qPpml: if (emptyInArray($search, "\x72\145\141\154\x5f\156\141\x6d\x65")) { goto Fo4wx; } goto SxdWV; RCZgf: $order = "\x72\x65\x67\x69\163\164\145\x72\137\x74\151\155\x65\x20\144\145\x73\143"; goto QM4ud; NeLxS: $records = Db::table("\143\x75\x73\x74\157\x6d\x65\162")->where($conditions)->page($page, $rows)->order($order)->field(true)->select(); goto sEnnY; zzKbp: uH2rM: goto BQbeU; qvD3w: esTMS: goto q6xaG; X0Rdx: $conditions["\x6e\x69\x63\153\156\x61\x6d\145"] = ["\x6c\151\x6b\145", "\x25" . $search["\156\x69\143\153\x6e\141\x6d\145"] . "\x25"]; goto CHG1E; ZO91U: $conditions["\x63\145\154\154\160\150\157\156\145"] = ["\154\151\153\145", "\x25" . $search["\x63\x65\154\154\160\150\157\156\145"] . "\45"]; goto zzKbp; sEnnY: foreach ($records as &$record) { goto lQIaG; Odq__: w4uVi: goto a4H2x; lQIaG: if (!empty($record["\150\x65\x61\x64\x69\155\147\x5f\x75\x72\x6c"])) { goto w4uVi; } goto yWXKU; yWXKU: $record["\150\145\141\x64\x69\x6d\x67\x5f\165\x72\154"] = "\x2f\x73\164\141\x74\151\143\57\151\155\x67\x2f\x64\145\x66\141\165\154\164\x2e\x70\156\147"; goto Odq__; J8L2I: lGVrz: goto CCHd4; a4H2x: if (!empty($record["\x6e\151\x63\x6b\x6e\141\155\145"])) { goto lGVrz; } goto HMDEa; HMDEa: $record["\156\x69\143\153\156\141\155\145"] = ''; goto J8L2I; CCHd4: uDg73: goto Vyn2o; Vyn2o: } goto bLasL; BuSw8: nlS3f: goto xi1Wk; kSAgu: PO02E: goto mPeO_; mPeO_: $conditions = []; goto Ig8Ot; bLasL: Ty6ae: goto oTRID; Ig8Ot: if (emptyInArray($search, "\156\x69\x63\153\x6e\x61\x6d\x65")) { goto O9EwB; } goto X0Rdx; oTRID: return ["\164\x6f\164\x61\x6c" => $totalCount, "\x72\157\x77\163" => $records]; goto KWX3i; KWX3i: } public function getInfos($customerId) { $infos = Db::table("\143\165\163\x74\x6f\x6d\145\x72")->where("\151\x64", $customerId)->field(true)->find(); return $infos; } public function save($customerId, $data) { goto TzTo1; Ml3ZS: GOPrM: goto d3ywO; d3ywO: $data["\155\157\x64\x69\x66\x79\137\x74\x69\155\x65"] = date("\131\x2d\x6d\55\x64\40\110\72\151\72\163"); goto GrHI4; GrHI4: $customerModel->data($data, true)->allowField(true)->save(); goto sdCK6; TzTo1: $customerModel = CustomerModel::get($customerId); goto iOIwd; WbMK4: exception("\346\x97\xa0\xe6\263\x95\346\211\xbe\xe5\210\260\xe8\xaf\xa5\345\xae\xa2\346\x88\267"); goto Ml3ZS; iOIwd: if ($customerModel) { goto GOPrM; } goto WbMK4; sdCK6: } }
